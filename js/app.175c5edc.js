(function(){"use strict";var E={9345:function(E,t,e){var n=e(9242),i=e(3396);function o(E,t){const e=(0,i.up)("router-view");return(0,i.wg)(),(0,i.j4)(e)}var r=e(89);const l={},A=(0,r.Z)(l,[["render",o]]);var T=A,L=e(2483);function R(E,t,e,n,o,r){const l=(0,i.up)("home");return(0,i.wg)(),(0,i.iD)("div",null,[(0,i.Wm)(l)])}const C=(0,i._)("h1",null,"HOME",-1),a=(0,i._)("p",null,"This application allows to transform the data related to the MPD from the excel file given by Airbus, to the excel file needed to enter this data with Amasis.",-1),s=(0,i._)("p",null,"To understand be",-1);function u(E,t,e,n,o,r){const l=(0,i.up)("router-link");return(0,i.wg)(),(0,i.iD)("div",null,[C,a,(0,i._)("p",null,[(0,i.Uk)("In order to do that, go to the "),(0,i.Wm)(l,{to:{name:"MPD-transformation"}},{default:(0,i.w5)((()=>[(0,i.Uk)("Application")])),_:1}),(0,i.Uk)(" tab and follow the instructions.")]),s])}var O={name:"Home",mounted(){}};const S=(0,r.Z)(O,[["render",u]]);var N=S,c={name:"HomeView",components:{Home:N}};const d=(0,r.Z)(c,[["render",R]]);var M=d;function H(E,t,e,n,o,r){const l=(0,i.up)("MPDTransformation");return(0,i.wg)(),(0,i.iD)("div",null,[(0,i.Wm)(l)])}var I=e(7139);const f=E=>((0,i.dD)("data-v-4276e084"),E=E(),(0,i.Cn)(),E),h=f((()=>(0,i._)("div",{class:"background"},null,-1))),D={id:"main-container",class:"p-5 text-center border rounded-5 shadow bg-white"},P=f((()=>(0,i._)("h1",{class:"mb-5"},"ðŸš€ MPD INDUCTION APP ðŸš€",-1))),F=f((()=>(0,i._)("p",null,"This application allows to transform the data from the MPD excel, to an excel file with the data structure required to enter it to Amasis.",-1))),p={class:"parameter-container"},m={class:"radio-btn-container"},U=f((()=>(0,i._)("span",null,"Aircraft model:",-1))),v=f((()=>(0,i._)("label",{for:"radio-320"},"320",-1))),V=f((()=>(0,i._)("label",{for:"radio-330"},"330",-1)));function b(E,t,e,o,r,l){return(0,i.wg)(),(0,i.iD)("div",null,[h,(0,i._)("div",D,[P,F,(0,i._)("div",p,[(0,i._)("div",m,[U,(0,i._)("div",null,[(0,i.wy)((0,i._)("input",{type:"radio",id:"radio-320",name:"aircraft-model",value:"320","onUpdate:modelValue":t[0]||(t[0]=E=>r.aircraftModel=E)},null,512),[[n.G2,r.aircraftModel]]),v]),(0,i._)("div",null,[(0,i.wy)((0,i._)("input",{type:"radio",id:"radio-330",name:"aircraft-model",value:"330","onUpdate:modelValue":t[1]||(t[1]=E=>r.aircraftModel=E)},null,512),[[n.G2,r.aircraftModel]]),V])])]),(0,i._)("input",{class:"form-control mt-4",type:"file",accept:".csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel",onChange:t[2]||(t[2]=(...E)=>l.readFile&&l.readFile(...E))},null,32),(0,i._)("button",{class:(0,I.C_)(["btn btn-primary mt-3",[""===this.workbook?"disabled":""]]),onClick:t[3]||(t[3]=(...E)=>l.transformFile&&l.transformFile(...E))},"TRANSFORM",2),(0,i._)("a",{class:(0,I.C_)(["btn mt-3",[""===this.download_workbook?"disabled btn-secondary":"btn-success"]]),onClick:t[4]||(t[4]=(...E)=>l.downloadFile&&l.downloadFile(...E))},"DOWNLOAD",2)])])}e(7658);const g=function(E){let t=E["TASK NUMBER"];return void 0===t?"":(t=t.replaceAll("\n",""),t)},w=function(E){let t=E["SKILL CODE"];return void 0===t?"":t.substring(0,3)},Y=function(E){let t=E["SOURCE"];return void 0===t?"":t.toUpperCase().match(/5|8|CMR|ALI|FAL/)?"O":"N"},k=function(E){let t=E["SOURCE"];return void 0===t?"":t.toUpperCase().match(/\*|ALI|FAL|CMR/)?"N":"Y"},_=function(E){return E.toUpperCase().match(/TCC/)?"N":E.toUpperCase().match(/NT/)?"Y":'"to be filled"'},B=function(E){let t=E["SOURCE"];if(void 0===t)return"";if(t.match(/\*\*/)){const E=["9","8","7","6","5"].filter((E=>t.match(E)));return E.length>0?E[0]+"**":"**"}if(t.match(/\*/)){const E=["9","8","7","6","5"].filter((E=>t.match(E)));return E.length>1?E[1]+E[0]+"*":E.length>0?E[0]+"*":"*"}if(t.match(/FAL/))return"FAL";if(t.match(/ALI/))return"ALI";if(t.match(/9|8|7|6|5/)){const E=["9","8","7","6","5"].filter((E=>t.match(E)));return E.length>2?E[2]+E[1]+E[0]:E.length>1?E[1]+E[0]:E[0]}return t.match(/MRB/)?"MRB":t.match(/CMP/)?"CMP":t.match(/LUR/)?"LUR":t.match(/SEMR/)?"SEM":t.match(/CPCP/)?"CPC":t.match(/VSB/)?"VSB":void 0},y=function(E){let t=E["TASK CODE"];return void 0===t?"":t.toUpperCase().substring(0,3)},j=function(E,t=!1,e="default"){let n;return"default"===e?n=t?E["SAMPLE THRESHOLD"]:E["100% THRESHOLD"]:"FH"===e?n=t?E["SAMPLE THRESHOLD FH"]:E["100% THRESHOLD FH"]:"FC"===e&&(n=t?E["SAMPLE THRESHOLD FC"]:E["100% THRESHOLD FC"]),void 0===n?"":n.match(/FH/)?"FH":""},Q=function(E,t=!1,e="default"){let n;if("default"===e?n=t?E["SAMPLE THRESHOLD"]:E["100% THRESHOLD"]:"FH"===e?n=t?E["SAMPLE THRESHOLD FH"]:E["100% THRESHOLD FH"]:"FC"===e&&(n=t?E["SAMPLE THRESHOLD FC"]:E["100% THRESHOLD FC"]),void 0===n)return"";let i=n.split("OR"),o=i.filter((E=>E.match(/FH/)));if(0==o.length)return"";let r=o[0].replaceAll("\n","").split(" ")[0];return r.length>6?r.substring(0,6):r},$=function(E,t=!1,e="default"){let n;return"default"===e?n=t?E["SAMPLE THRESHOLD"]:E["100% THRESHOLD"]:"FH"===e?n=t?E["SAMPLE THRESHOLD FH"]:E["100% THRESHOLD FH"]:"FC"===e&&(n=t?E["SAMPLE THRESHOLD FC"]:E["100% THRESHOLD FC"]),void 0===n?"":n.match(/FC/)?"CY":""},K=function(E,t=!1,e="default"){let n;if("default"===e?n=t?E["SAMPLE THRESHOLD"]:E["100% THRESHOLD"]:"FH"===e?n=t?E["SAMPLE THRESHOLD FH"]:E["100% THRESHOLD FH"]:"FC"===e&&(n=t?E["SAMPLE THRESHOLD FC"]:E["100% THRESHOLD FC"]),void 0===n)return"";let i=n.split("OR"),o=i.filter((E=>E.match(/FC/)));if(0==o.length)return"";let r=o[0].replaceAll("\n","").split(" ")[0];return r.length>6?r.substring(0,6):r},X=function(E,t=!1,e="default"){let n;return"default"===e?n=t?E["SAMPLE THRESHOLD"]:E["100% THRESHOLD"]:"FH"===e?n=t?E["SAMPLE THRESHOLD FH"]:E["100% THRESHOLD FH"]:"FC"===e&&(n=t?E["SAMPLE THRESHOLD FC"]:E["100% THRESHOLD FC"]),void 0===n?"":n.match(/MO/)?"MO":n.match(/YE/)?"YE":n.match(/DY/)?"DY":""},x=function(E,t=!1,e="default"){let n;if("default"===e?n=t?E["SAMPLE THRESHOLD"]:E["100% THRESHOLD"]:"FH"===e?n=t?E["SAMPLE THRESHOLD FH"]:E["100% THRESHOLD FH"]:"FC"===e&&(n=t?E["SAMPLE THRESHOLD FC"]:E["100% THRESHOLD FC"]),void 0===n)return"";let i=n.split("OR"),o=i.filter((E=>E.match(/MO|YE|DY/)));if(0==o.length)return"";let r=o[0].replaceAll("\n","").split(" ")[0];return r.length>6?r.substring(0,6):r},G=function(E,t=!1,e="default"){let n;if("default"===e?n=t?E["SAMPLE INTERVAL"]:E["100% INTERVAL"]:"FH"===e?n=t?E["SAMPLE INTERVAL FH"]:E["100% INTERVAL FH"]:"FC"===e&&(n=t?E["SAMPLE INTERVAL FC"]:E["100% INTERVAL FC"]),void 0===n)return"";let i=n.split("OR"),o=i.filter((E=>E.match(/FH/)));if(0==o.length)return"";let r=o[0].replaceAll("\n","").split(" ")[0];return r.length>6?r.substring(0,6):r},Z=function(E,t=!1,e="default"){let n;if("default"===e?n=t?E["SAMPLE INTERVAL"]:E["100% INTERVAL"]:"FH"===e?n=t?E["SAMPLE INTERVAL FH"]:E["100% INTERVAL FH"]:"FC"===e&&(n=t?E["SAMPLE INTERVAL FC"]:E["100% INTERVAL FC"]),void 0===n)return"";let i=n.split("OR"),o=i.filter((E=>E.match(/FC/)));if(0==o.length)return"";let r=o[0].replaceAll("\n","").split(" ")[0];return r.length>6?r.substring(0,6):r},z=function(E,t=!1,e="default"){let n;return"default"===e?n=t?E["SAMPLE INTERVAL"]:E["100% INTERVAL"]:"FH"===e?n=t?E["SAMPLE INTERVAL FH"]:E["100% INTERVAL FH"]:"FC"===e&&(n=t?E["SAMPLE INTERVAL FC"]:E["100% INTERVAL FC"]),void 0===n?"":n.match(/MO/)?"MO":n.match(/YE/)?"YE":n.match(/DY/)?"DY":""},W=function(E,t=!1,e="default"){let n;if("default"===e?n=t?E["SAMPLE INTERVAL"]:E["100% INTERVAL"]:"FH"===e?n=t?E["SAMPLE INTERVAL FH"]:E["100% INTERVAL FH"]:"FC"===e&&(n=t?E["SAMPLE INTERVAL FC"]:E["100% INTERVAL FC"]),void 0===n)return"";let i=n.split("OR"),o=i.filter((E=>E.match(/MO|YE|DY/)));if(0==o.length)return"";let r=o[0].replaceAll("\n","").split(" ")[0];return r.length>6?r.substring(0,6):r},q=function(E,t="default"){const e=E["TCI"];if(void 0!==e&&e.match(/T/))return"TCC";let n,i;return"default"===t?n=E["100% THRESHOLD"]:"FH"===t?n=E["100% THRESHOLD FH"]:"FC"===t&&(n=E["100% THRESHOLD FC"]),"default"===t?i=E["100% INTERVAL"]:"FH"===t?i=E["100% INTERVAL FH"]:"FC"===t&&(i=E["100% INTERVAL FC"]),void 0!==n&&n.match(/^4 C/)||void 0!==i&&i.match(/^4 C/)?"4C":void 0!==n&&n.match(/NOTE/)&&n.match(/FH|FC|DY|YE|MO/)||void 0!==i&&i.match(/NOTE/)&&i.match(/FH|FC|DY|YE|MO/)?"NT":'"To be filled"'},J=function(E){let t=E["ZONE"];if(void 0===t)return"";let e=t.split("\n");e=e.filter((E=>0!==E.trim().length));while(e.length<22)e.push("");return e},EE=function(E){let t=E["ACCESS"];if(void 0===t)return"";t=t.replaceAll("\n"," ");let e=t.split(" ").filter((E=>""!=E));if(e.length>=50)return e.slice(0,50);while(e.length<50)e.push("");return e},tE=function(E){let t=E["TASKM.H."];return void 0===t||t.match(/N\/A|TBC/)||""==t?"":t.split("\n")[0].replaceAll(".",",")},eE=function(E){let t=E["MEN"];return void 0===t?"":t.split("\n")[0]},nE=function(E){let t=E["DESCRIPTION"];if(void 0===t)return"";let e=t.split("\n")[0];while(e.length>40)e=e.split(" ").slice(0,-1).join(" ");return e.toUpperCase()},iE=function(E){let t=E["DESCRIPTION"],e=E["PREPARATION"],n=E["APPLICABILITY"];if(""!==e&&(t+="\nPREPARATION\n"+e),""!==n&&(t+="\nEFFECTIVITY\n"+n),void 0===t)return"";t=t.replaceAll("\\","");let i=t.split("\n").filter(((E,t)=>""!=E&&0!==t));for(let r=0;r<i.length;r++)if(i[r].length>75){let E=i[r].split(" ");i=[...i.slice(0,r),E.slice(0,Math.round(E.length/2)).join(" "),E.slice(Math.round(E.length/2)).join(" "),...i.slice(r+1)],r=0}if(16==i.length)return i;if(i.length<16){while(i.length<16)i.push("");return i}i=[""];let o=t.split("\n").join(" ").replaceAll("  "," ").replaceAll("  "," ").split(" ");for(let r of o)i[i.length-1].length+r.length+1<=75?i[i.length-1]+=`${r} `:(i[i.length-1]=i[i.length-1].trim(),i.push(`${r} `));if(16==i.length)return i;if(i.length<16){while(i.length<16)i.push("");return i}return i.slice(0,16)},oE=function(E){let t=E["TASK NUMBER"];return void 0===t?"":t.substring(0,2)},rE=function(E){const t=E["REFERENCE"],e=E["SOURCE TASK REFERENCE"];let n;if((void 0===t||""===t)&&(void 0===e||""===e))return["","","","","","","","","",""];n=void 0===t||""===t?e.split("\n"):void 0===e||""===e?t.split("\n"):[...t.split("\n"),...e.split("\n")];let i=n.filter((E=>0!==E.trim().length)).reduce(((E,e,n)=>{if(n>4)return E;{const i=e.split(" ");return 1===i.length?0===n&&void 0!==t&&""!==t?[...E,i[0],"AMM"]:[...E,i[0],"unknown"]:2===i.length?[...E,i[1],i[0]]:e.match(/APX|APPENDIX/)?[...E,e,"MPD"]:[...E,i.slice(1).join(" "),i[0]]}}),[]);while(i.length<10)i.push("");return i},lE=function(E){return Object.values(E.slice(0,1)[0]).map((E=>E.toLowerCase())).filter((E=>E.includes("revision")))[0].split("\n")[0].split(":")[1].trim()},AE=function(E){const t=Object.values(E.slice(0,1)[0]).map((E=>E.toLowerCase())).filter((E=>E.includes("revision")))[0].split("\n")[1].split(":")[1].trim();let e;switch(t.split(" ")[0]){case"jan":e="01";break;case"feb":e="02";break;case"mar":e="03";break;case"apr":e="04";break;case"may":e="05";break;case"jun":e="06";break;case"jul":e="07";break;case"aug":e="08";break;case"sep":e="09";break;case"oct":e="10";break;case"nov":e="11";break;case"dic":e="12";break;default:e="to-be-specifyed"}return t.split("/")[0].split(" ")[1]+"/"+e+"/"+t.split("/")[1]},TE=function(E){let t=E["REV CODE"];return void 0===t?"":t},LE=function(E,t){let e="",n=E["ZONE"];if(void 0!==n){let E=n.split("\n");E.length>22&&(e+="(more than 22 zones)")}let i=E["ACCESS"];if(void 0!==i){i=i.replaceAll("\n"," ");let E=i.split(" ").filter((E=>""!=E));E.length>50&&(e+="(more than 50 access)")}const o=E["REFERENCE"],r=E["SOURCE TASK REFERENCE"];let l;void 0!==o&&""!==o&&void 0!==r&&""!==r?l=[...o.split("\n"),...r.split("\n")]:void 0===o||""===o?l=r.split("\n"):void 0!==r&&""!==r||(l=o.split("\n")),l.length>5&&(e+="(more than 5 references)");const A=t?["SAMPLE THRESHOLD","SAMPLE INTERVAL","100% THRESHOLD","100% INTERVAL","SAMPLE THRESHOLD FH","SAMPLE INTERVAL FH","100% THRESHOLD FH","100% INTERVAL FH","SAMPLE THRESHOLD FC","SAMPLE INTERVAL FC","100% THRESHOLD FC","100% INTERVAL FC"]:["SAMPLE THRESHOLD","SAMPLE INTERVAL","100% THRESHOLD","100% INTERVAL"];return A.forEach((t=>{const n=E[t];n&&n.includes("CRR")&&(e+=`(CRR in "${t}")`)})),e},RE=e(7092);var CE={name:"MPDTransformation",data(){return{aircraftModel:"320",workbook:"",download_workbook:"",numRevisionValue:"",dateRevisionValue:""}},computed:{optimized(){return"330"===this.aircraftModel}},methods:{readFile(){const E=document.querySelectorAll("input")[2];this.file=E.files[0];const t=new FileReader;return t.onload=E=>{const t=E.target.result,e=RE.read(t,{type:"binary"});this.workbook=e},t.readAsBinaryString(this.file)},transformFile(){this.optimized?this.transformFileOptimized():this.transformFileNormal()},transformFileNormal(){const E=this.workbook.Sheets["MPD"],t=RE.utils.sheet_to_json(E,{header:["REV CODE","SECTION","TASK NUMBER","SOURCE TASK REFERENCE","ACCESS","PREPARATION","ZONE","DESCRIPTION","SKILL CODE","TASK CODE","SAMPLE THRESHOLD","SAMPLE INTERVAL","100% THRESHOLD","100% INTERVAL","SOURCE","TCI","RSC","TPS","REFERENCE","MEN","TASKM.H.","ACCESSM.H.","PREP.M.H.","APPLICABILITY"]});this.numRevisionValue="R"+lE(t),this.dateRevisionValue=AE(t);let e=t.slice(2),n=[];e.forEach((E=>{n.push({"REFERENCE DE LA CARTE":g(E),"TYPE DE LA CARTE":"MC",SPECIALITE:w(E),CONTROLE:Y(E),REPORT:k(E),"OUT OF PHASE":_(q(E)),PHASE:"",POSTE:"",MRB:B(E),"CODE TACHE":y(E),NOTE:320===this.aircraftModel?'"to be filled"':"N","TEXT NOTE 1":"","TEXT NOTE 2":"","TEXT NOTE 3":"","COMPTEUR SEUIL 1":j(E),"VALEUR SEUIL 1":Q(E),"COMPTEUR SEUIL 2":$(E),"VALEUR SEUIL 2":K(E),"COMPTEUR SEUIL 3":X(E),"VALEUR SEUIL 3":x(E),HEURES:G(E),CYCLES:Z(E),"CODE CAL":z(E),CALENDAIRE:W(E),"CODE CHECK":q(E),"CODE ATYPIQUE 1":"","INTERVAL ATYPIQUE 1":"","CODE ATYPIQUE 2":"","INTERVAL ATYPIQUE 2":"","CODE ATYPIQUE 3":"","INTERVAL ATYPIQUE 3":"","TOLERANCE - TOLERANCE":"N","TOLERANCE - NAME":"","TOLERANCE - HEURES":"","TOLERANCE-CYCLES":"","TOLERANCE - CALENDAIRE":"","TOLERANCE - COD CALENDAIRE":"","TOLERANCE - CPT1":"","TOLERANCE - CPT2":"","TOLERANCE - CPT3":"","METHOD CALC CALENDAIRE":"","METHOD CALC AUTRES":"",...J(E).reduce(((E,t,e)=>(E[`A/C ZONE ${e+1}`]=t,E)),{}),...EE(E).reduce(((E,t,e)=>(E[`ACCESS ${e+1}`]=t,E)),{}),"FAMILLE MSN 1":"","FAMILLE MSN 2":"","FAMILLE MSN 3":"","FAMILLE MSN 4":"","FAMILLE MSN 5":"",RESSOURCE:w(E),"CHARGE HH":tE(E),NOMBRE:eE(E),"RESSOURCE 2":"","CHARGE HH 2":"","NOMBRE 2":"","RESSOURCE 3":"","CHARGE HH 3":"","NOMBRE 3":"","LIBELLE DE LA CARTE":nE(E),...iE(E).reduce(((E,t,e)=>(E[`TEXTE ${e+1}`]=t,E)),{}),ATA:oE(E),"LIBELLE DE L'ATA":"",...rE(E).reduce(((E,t,e)=>(e%2===0?E["REFERENCE DOCUMENT LIE "+(e+1-e/2)]=t:E["TYPE DOCUMENT LIE "+(e+1)/2]=t,E)),{}),"NUMERO AMENDEMENT":'"to be filled"',"DATE AMENDEMENT":'"to be filled"',"NUMERO REVISION":this.numRevisionValue,"DATE REVISION":this.dateRevisionValue,"TYPE DE MODIFICATION":TE(E),COMMENTS:LE(E,this.optimized)}),(void 0!==E["SAMPLE THRESHOLD"]&&""!==E["SAMPLE THRESHOLD"]||void 0!==E["SAMPLE INTERVAL"]&&""!==E["SAMPLE INTERVAL"])&&n.push({"REFERENCE DE LA CARTE":g(E)+"S","TYPE DE LA CARTE":"MC",SPECIALITE:w(E),CONTROLE:Y(E),REPORT:k(E),"OUT OF PHASE":_(q(E)),PHASE:"",POSTE:"",MRB:B(E),"CODE TACHE":y(E),NOTE:320===this.aircraftModel?'"to be filled"':"N","TEXT NOTE 1":"","TEXT NOTE 2":"","TEXT NOTE 3":"","COMPTEUR SEUIL 1":j(E,!0),"VALEUR SEUIL 1":Q(E,!0),"COMPTEUR SEUIL 2":$(E,!0),"VALEUR SEUIL 2":K(E,!0),"COMPTEUR SEUIL 3":X(E,!0),"VALEUR SEUIL 3":x(E,!0),HEURES:G(E,!0),CYCLES:Z(E,!0),"CODE CAL":z(E,!0),CALENDAIRE:W(E,!0),"CODE CHECK":q(E),"CODE ATYPIQUE 1":"","INTERVAL ATYPIQUE 1":"","CODE ATYPIQUE 2":"","INTERVAL ATYPIQUE 2":"","CODE ATYPIQUE 3":"","INTERVAL ATYPIQUE 3":"","TOLERANCE - TOLERANCE":"N","TOLERANCE - NAME":"","TOLERANCE - HEURES":"","TOLERANCE-CYCLES":"","TOLERANCE - CALENDAIRE":"","TOLERANCE - COD CALENDAIRE":"","TOLERANCE - CPT1":"","TOLERANCE - CPT2":"","TOLERANCE - CPT3":"","METHOD CALC CALENDAIRE":"","METHOD CALC AUTRES":"",...J(E).reduce(((E,t,e)=>(E[`A/C ZONE ${e+1}`]=t,E)),{}),...EE(E).reduce(((E,t,e)=>(E[`ACCESS ${e+1}`]=t,E)),{}),"FAMILLE MSN 1":"","FAMILLE MSN 2":"","FAMILLE MSN 3":"","FAMILLE MSN 4":"","FAMILLE MSN 5":"",RESSOURCE:w(E),"CHARGE HH":tE(E),NOMBRE:eE(E),"RESSOURCE 2":"","CHARGE HH 2":"","NOMBRE 2":"","RESSOURCE 3":"","CHARGE HH 3":"","NOMBRE 3":"","LIBELLE DE LA CARTE":nE(E),...iE(E).reduce(((E,t,e)=>(E[`TEXTE ${e+1}`]=t,E)),{}),ATA:oE(E),"LIBELLE DE L'ATA":"",...rE(E).reduce(((E,t,e)=>(e%2===0?E["REFERENCE DOCUMENT LIE "+(e+1-e/2)]=t:E["TYPE DOCUMENT LIE "+(e+1)/2]=t,E)),{}),"NUMERO AMENDEMENT":'"to be filled"',"DATE AMENDEMENT":'"to be filled"',"NUMERO REVISION":this.numRevisionValue,"DATE REVISION":this.dateRevisionValue,"TYPE DE MODIFICATION":TE(E),COMMENTS:LE(E,this.optimized)})}));const i=RE.utils.json_to_sheet(n);this.download_workbook=RE.utils.book_new(),this.download_workbook.SheetNames.push("MPD induction AMASIS"),this.download_workbook.Sheets["MPD induction AMASIS"]=i},transformFileOptimized(){const E=this.workbook.Sheets["MPD"],t=RE.utils.sheet_to_json(E,{header:["REV CODE","SECTION","TASK NUMBER","SOURCE TASK REFERENCE","ACCESS","PREPARATION","ZONE","DESCRIPTION","SKILL CODE","TASK CODE","SAMPLE THRESHOLD","SAMPLE INTERVAL","100% THRESHOLD","100% INTERVAL","SAMPLE THRESHOLD FH","SAMPLE INTERVAL FH","100% THRESHOLD FH","100% INTERVAL FH","SAMPLE THRESHOLD FC","SAMPLE INTERVAL FC","100% THRESHOLD FC","100% INTERVAL FC","SOURCE","TCI","RSC","TPS","REFERENCE","MEN","TASKM.H.","ACCESSM.H.","PREP.M.H.","APPLICABILITY"]});this.numRevisionValue="R"+lE(t),this.dateRevisionValue=AE(t);let e=t.slice(3),n=[[],[],[]];e.forEach((E=>{["FH","FC"].forEach(((t,e)=>{let i;i=void 0!==E[`100% THRESHOLD ${t}`]&&""!==E[`100% THRESHOLD ${t}`]||void 0!==E[`100% INTERVAL ${t}`]&&""!==E[`100% INTERVAL ${t}`]?t:"default",n[e].push({"REFERENCE DE LA CARTE":g(E),"TYPE DE LA CARTE":"MC",SPECIALITE:w(E),CONTROLE:Y(E),REPORT:k(E),"OUT OF PHASE":_(q(E,i)),PHASE:"",POSTE:"",MRB:B(E),"CODE TACHE":y(E),NOTE:320===this.aircraftModel?'"to be filled"':"N","TEXT NOTE 1":"","TEXT NOTE 2":"","TEXT NOTE 3":"","COMPTEUR SEUIL 1":j(E,!1,i),"VALEUR SEUIL 1":Q(E,!1,i),"COMPTEUR SEUIL 2":$(E,!1,i),"VALEUR SEUIL 2":K(E,!1,i),"COMPTEUR SEUIL 3":X(E,!1,i),"VALEUR SEUIL 3":x(E,!1,i),HEURES:G(E,!1,i),CYCLES:Z(E,!1,i),"CODE CAL":z(E,!1,i),CALENDAIRE:W(E,!1,i),"CODE CHECK":q(E,i),"CODE ATYPIQUE 1":"","INTERVAL ATYPIQUE 1":"","CODE ATYPIQUE 2":"","INTERVAL ATYPIQUE 2":"","CODE ATYPIQUE 3":"","INTERVAL ATYPIQUE 3":"","TOLERANCE - TOLERANCE":"N","TOLERANCE - NAME":"","TOLERANCE - HEURES":"","TOLERANCE-CYCLES":"","TOLERANCE - CALENDAIRE":"","TOLERANCE - COD CALENDAIRE":"","TOLERANCE - CPT1":"","TOLERANCE - CPT2":"","TOLERANCE - CPT3":"","METHOD CALC CALENDAIRE":"","METHOD CALC AUTRES":"",...J(E).reduce(((E,t,e)=>(E[`A/C ZONE ${e+1}`]=t,E)),{}),...EE(E).reduce(((E,t,e)=>(E[`ACCESS ${e+1}`]=t,E)),{}),"FAMILLE MSN 1":"","FAMILLE MSN 2":"","FAMILLE MSN 3":"","FAMILLE MSN 4":"","FAMILLE MSN 5":"",RESSOURCE:w(E),"CHARGE HH":tE(E),NOMBRE:eE(E),"RESSOURCE 2":"","CHARGE HH 2":"","NOMBRE 2":"","RESSOURCE 3":"","CHARGE HH 3":"","NOMBRE 3":"","LIBELLE DE LA CARTE":nE(E),...iE(E).reduce(((E,t,e)=>(E[`TEXTE ${e+1}`]=t,E)),{}),ATA:oE(E),"LIBELLE DE L'ATA":"",...rE(E).reduce(((E,t,e)=>(e%2===0?E["REFERENCE DOCUMENT LIE "+(e+1-e/2)]=t:E["TYPE DOCUMENT LIE "+(e+1)/2]=t,E)),{}),"NUMERO AMENDEMENT":'"to be filled"',"DATE AMENDEMENT":'"to be filled"',"NUMERO REVISION":this.numRevisionValue,"DATE REVISION":this.dateRevisionValue,"TYPE DE MODIFICATION":TE(E),COMMENTS:LE(E,this.optimized)}),(void 0!==E["SAMPLE THRESHOLD"+("default"===i?"":` ${i}`)]&&""!==E["SAMPLE THRESHOLD"+("default"===i?"":` ${i}`)]||void 0!==E["SAMPLE INTERVAL"+("default"===i?"":` ${i}`)]&&""!==E["SAMPLE INTERVAL"+("default"===i?"":` ${i}`)])&&n[e].push({"REFERENCE DE LA CARTE":g(E)+"S","TYPE DE LA CARTE":"MC",SPECIALITE:w(E),CONTROLE:Y(E),REPORT:k(E),"OUT OF PHASE":_(q(E,i)),PHASE:"",POSTE:"",MRB:B(E),"CODE TACHE":y(E),NOTE:320===this.aircraftModel?'"to be filled"':"N","TEXT NOTE 1":"","TEXT NOTE 2":"","TEXT NOTE 3":"","COMPTEUR SEUIL 1":j(E,!0,i),"VALEUR SEUIL 1":Q(E,!0,i),"COMPTEUR SEUIL 2":$(E,!0,i),"VALEUR SEUIL 2":K(E,!0,i),"COMPTEUR SEUIL 3":X(E,!0,i),"VALEUR SEUIL 3":x(E,!0,i),HEURES:G(E,!0,i),CYCLES:Z(E,!0,i),"CODE CAL":z(E,!0,i),CALENDAIRE:W(E,!0,i),"CODE CHECK":q(E,i),"CODE ATYPIQUE 1":"","INTERVAL ATYPIQUE 1":"","CODE ATYPIQUE 2":"","INTERVAL ATYPIQUE 2":"","CODE ATYPIQUE 3":"","INTERVAL ATYPIQUE 3":"","TOLERANCE - TOLERANCE":"N","TOLERANCE - NAME":"","TOLERANCE - HEURES":"","TOLERANCE-CYCLES":"","TOLERANCE - CALENDAIRE":"","TOLERANCE - COD CALENDAIRE":"","TOLERANCE - CPT1":"","TOLERANCE - CPT2":"","TOLERANCE - CPT3":"","METHOD CALC CALENDAIRE":"","METHOD CALC AUTRES":"",...J(E).reduce(((E,t,e)=>(E[`A/C ZONE ${e+1}`]=t,E)),{}),...EE(E).reduce(((E,t,e)=>(E[`ACCESS ${e+1}`]=t,E)),{}),"FAMILLE MSN 1":"","FAMILLE MSN 2":"","FAMILLE MSN 3":"","FAMILLE MSN 4":"","FAMILLE MSN 5":"",RESSOURCE:w(E),"CHARGE HH":tE(E),NOMBRE:eE(E),"RESSOURCE 2":"","CHARGE HH 2":"","NOMBRE 2":"","RESSOURCE 3":"","CHARGE HH 3":"","NOMBRE 3":"","LIBELLE DE LA CARTE":nE(E),...iE(E).reduce(((E,t,e)=>(E[`TEXTE ${e+1}`]=t,E)),{}),ATA:oE(E),"LIBELLE DE L'ATA":"",...rE(E).reduce(((E,t,e)=>(e%2===0?E["REFERENCE DOCUMENT LIE "+(e+1-e/2)]=t:E["TYPE DOCUMENT LIE "+(e+1)/2]=t,E)),{}),"NUMERO AMENDEMENT":'"to be filled"',"DATE AMENDEMENT":'"to be filled"',"NUMERO REVISION":this.numRevisionValue,"DATE REVISION":this.dateRevisionValue,"TYPE DE MODIFICATION":TE(E),COMMENTS:LE(E,this.optimized)})}))}));const i=RE.utils.json_to_sheet(n[0]),o=RE.utils.json_to_sheet(n[1]);this.download_workbook=RE.utils.book_new(),this.download_workbook.SheetNames.push("MPD FH induction AMASIS"),this.download_workbook.Sheets["MPD FH induction AMASIS"]=i,this.download_workbook.SheetNames.push("MPD FC induction AMASIS"),this.download_workbook.Sheets["MPD FC induction AMASIS"]=o},downloadFile(){let E="file";RE.writeFile(this.download_workbook,`${E}.xlsx`)}},watch:{optimized(){this.download_workbook=""},workbook(){this.download_workbook=""}}};const aE=(0,r.Z)(CE,[["render",b],["__scopeId","data-v-4276e084"]]);var sE=aE,uE={name:"MPDTransformationView",components:{MPDTransformation:sE}};const OE=(0,r.Z)(uE,[["render",H]]);var SE=OE;const NE=[{path:"/",name:"home",component:M},{path:"/MPD-transformation",name:"MPD-transformation",component:SE}],cE=(0,L.p7)({history:(0,L.r5)(),routes:NE});var dE=cE,ME=e(65),HE=(0,ME.MT)({state:{},getters:{},mutations:{},actions:{},modules:{}});e(2166);(0,n.ri)(T).use(HE).use(dE).mount("#app")}},t={};function e(n){var i=t[n];if(void 0!==i)return i.exports;var o=t[n]={exports:{}};return E[n].call(o.exports,o,o.exports,e),o.exports}e.m=E,function(){var E=[];e.O=function(t,n,i,o){if(!n){var r=1/0;for(L=0;L<E.length;L++){n=E[L][0],i=E[L][1],o=E[L][2];for(var l=!0,A=0;A<n.length;A++)(!1&o||r>=o)&&Object.keys(e.O).every((function(E){return e.O[E](n[A])}))?n.splice(A--,1):(l=!1,o<r&&(r=o));if(l){E.splice(L--,1);var T=i();void 0!==T&&(t=T)}}return t}o=o||0;for(var L=E.length;L>0&&E[L-1][2]>o;L--)E[L]=E[L-1];E[L]=[n,i,o]}}(),function(){e.n=function(E){var t=E&&E.__esModule?function(){return E["default"]}:function(){return E};return e.d(t,{a:t}),t}}(),function(){e.d=function(E,t){for(var n in t)e.o(t,n)&&!e.o(E,n)&&Object.defineProperty(E,n,{enumerable:!0,get:t[n]})}}(),function(){e.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(E){if("object"===typeof window)return window}}()}(),function(){e.o=function(E,t){return Object.prototype.hasOwnProperty.call(E,t)}}(),function(){e.r=function(E){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(E,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(E,"__esModule",{value:!0})}}(),function(){var E={143:0};e.O.j=function(t){return 0===E[t]};var t=function(t,n){var i,o,r=n[0],l=n[1],A=n[2],T=0;if(r.some((function(t){return 0!==E[t]}))){for(i in l)e.o(l,i)&&(e.m[i]=l[i]);if(A)var L=A(e)}for(t&&t(n);T<r.length;T++)o=r[T],e.o(E,o)&&E[o]&&E[o][0](),E[o]=0;return e.O(L)},n=self["webpackChunkproject"]=self["webpackChunkproject"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var n=e.O(void 0,[998],(function(){return e(9345)}));n=e.O(n)})();
//# sourceMappingURL=app.175c5edc.js.map