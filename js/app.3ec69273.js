(function(){"use strict";var e={239:function(e,t,n){var i=n(9242),l=n(3396),o=n.p+"img/sbt.c2cad1cc.png";const r={class:"navbar-container"},a=(0,l._)("div",{class:"logo-header-container"},[(0,l._)("img",{src:o,alt:""})],-1);function E(e,t){const n=(0,l.up)("router-link"),i=(0,l.up)("router-view");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l._)("div",r,[(0,l._)("nav",null,[(0,l.Wm)(n,{class:"nav-element",to:{name:"home"}},{default:(0,l.w5)((()=>[(0,l.Uk)("Home")])),_:1}),(0,l.Wm)(n,{class:"nav-element",to:{name:"MPD-transformation"}},{default:(0,l.w5)((()=>[(0,l.Uk)("MPD Induction")])),_:1})]),a]),(0,l.Wm)(i)],64)}var s=n(89);const c={},u=(0,s.Z)(c,[["render",E]]);var d=u,A=n(2483);function T(e,t,n,i,o,r){const a=(0,l.up)("home");return(0,l.wg)(),(0,l.iD)("div",null,[(0,l.Wm)(a)])}var p=n(7139);const R=e=>((0,l.dD)("data-v-79f76efc"),e=e(),(0,l.Cn)(),e),f=R((()=>(0,l._)("div",{class:"background"},null,-1))),C={class:"main-container p-5 text-center border rounded-5 shadow"},h=R((()=>(0,l._)("h1",null,"HOME",-1))),m=R((()=>(0,l._)("p",null,"This application allows to transform the data related to the MPD from an excel file, to another excel file with the structure nedded to upload this data to Amasis.",-1))),L=R((()=>(0,l._)("p",null,"To be sure that this application is used correctly, and to avoid possible mistakes, the following manuals will help understanding it:",-1))),S={class:"list-link-element"},N={class:"me-2"},O=["href"],I={key:1,class:"icon icon-24 icon-video"};function M(e,t,n,i,o,r){const a=(0,l.up)("router-link");return(0,l.wg)(),(0,l.iD)("div",null,[f,(0,l._)("div",C,[h,m,(0,l._)("p",null,[(0,l.Uk)("In order use the app, go to the "),(0,l.Wm)(a,{class:"inline-btn",to:{name:"MPD-transformation"}},{default:(0,l.w5)((()=>[(0,l.Uk)("MPD INDUCTION")])),_:1}),(0,l.Uk)(" page.")]),L,(0,l._)("ul",null,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(o.manuals,((e,t)=>((0,l.wg)(),(0,l.iD)("li",{key:t},[(0,l._)("span",S,[(0,l._)("span",N,(0,p.zw)(e.name),1),e.pdf.length>0?((0,l.wg)(),(0,l.iD)("a",{key:0,class:"icon icon-24 icon-pdf",href:e.pdf,target:"_blank"},null,8,O)):(0,l.kq)("",!0),e.video.length>0?((0,l.wg)(),(0,l.iD)("a",I)):(0,l.kq)("",!0)])])))),128))])])])}var g={name:"Home",data(){return{manuals:[{name:"MPD INDUCTION - AIRBUS",pdf:"https://stnbgc.github.io/mpd-induction/Manuals/mpd-induction-airbus-manual.pdf",video:""},{name:"MPD INDUCTION - ATR",pdf:"https://stnbgc.github.io/mpd-induction/Manuals/mpd-induction-atr-manual.pdf",video:""}]}}};const D=(0,s.Z)(g,[["render",M],["__scopeId","data-v-79f76efc"]]);var v=D,H={name:"HomeView",components:{Home:v}};const P=(0,s.Z)(H,[["render",T]]);var b=P;const F=e=>((0,l.dD)("data-v-151f0712"),e=e(),(0,l.Cn)(),e),U=F((()=>(0,l._)("div",{class:"background"},null,-1))),w={id:"main-container",class:"p-5 text-center border rounded-5 shadow bg-white"},V=F((()=>(0,l._)("h1",{class:"mb-5"},"üöÄ MPD INDUCTION APP üöÄ",-1))),k=F((()=>(0,l._)("p",null,"This application allows to transform the data from the MPD excel, to an excel file with the data structure required to enter it to Amasis.",-1))),_=F((()=>(0,l._)("nav",null,[(0,l._)("div",{class:"nav nav-tabs",id:"nav-tab",role:"tablist"},[(0,l._)("button",{class:"nav-link active",id:"nav-airbus-tab","data-bs-toggle":"tab","data-bs-target":"#nav-airbus",type:"button",role:"tab","aria-controls":"nav-airbus","aria-selected":"true"},"Airbus"),(0,l._)("button",{class:"nav-link",id:"nav-atr-tab","data-bs-toggle":"tab","data-bs-target":"#nav-atr",type:"button",role:"tab","aria-controls":"nav-atr","aria-selected":"false"},"ATR"),(0,l._)("button",{class:"nav-link",id:"nav-arkia-tab","data-bs-toggle":"tab","data-bs-target":"#nav-arkia",type:"button",role:"tab","aria-controls":"nav-atr","aria-selected":"false"},"Arkia")])],-1))),y={class:"tab-content",id:"nav-tabContent"},Y={class:"tab-pane fade show active",id:"nav-airbus",role:"tabpanel","aria-labelledby":"nav-airbus-tab",tabindex:"0"},x={class:"tab-pane fade",id:"nav-atr",role:"tabpanel","aria-labelledby":"nav-atr-tab",tabindex:"0"},B={class:"tab-pane fade",id:"nav-arkia",role:"tabpanel","aria-labelledby":"nav-arkia-tab",tabindex:"0"};function K(e,t,n,i,o,r){const a=(0,l.up)("MPDTransformation"),E=(0,l.up)("MPDTransformationATR"),s=(0,l.up)("MPDTransformationArkia");return(0,l.wg)(),(0,l.iD)("div",null,[U,(0,l._)("div",w,[V,k,_,(0,l._)("div",y,[(0,l._)("div",Y,[(0,l.Wm)(a)]),(0,l._)("div",x,[(0,l.Wm)(E)]),(0,l._)("div",B,[(0,l.Wm)(s)])])])])}const j=e=>((0,l.dD)("data-v-39c369d7"),e=e(),(0,l.Cn)(),e),Q={class:"d-flex flex-column"},$={class:"parameter-container"},Z={class:"radio-btn-container"},q=j((()=>(0,l._)("span",null,"Aircraft model:",-1))),X=j((()=>(0,l._)("label",{for:"radio-320"},"320",-1))),G=j((()=>(0,l._)("label",{for:"radio-330"},"330",-1)));function W(e,t,n,o,r,a){return(0,l.wg)(),(0,l.iD)("div",Q,[(0,l._)("div",$,[(0,l._)("div",Z,[q,(0,l._)("div",null,[(0,l.wy)((0,l._)("input",{type:"radio",id:"radio-320",name:"aircraft-model",value:"320","onUpdate:modelValue":t[0]||(t[0]=e=>r.aircraftModel=e)},null,512),[[i.G2,r.aircraftModel]]),X]),(0,l._)("div",null,[(0,l.wy)((0,l._)("input",{type:"radio",id:"radio-330",name:"aircraft-model",value:"330","onUpdate:modelValue":t[1]||(t[1]=e=>r.aircraftModel=e)},null,512),[[i.G2,r.aircraftModel]]),G])])]),(0,l._)("input",{class:"form-control mt-4",type:"file",accept:".csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel",onChange:t[2]||(t[2]=(...e)=>a.readFile&&a.readFile(...e))},null,32),(0,l._)("button",{class:(0,p.C_)(["btn btn-primary mt-3",[""===this.workbook?"disabled":""]]),onClick:t[3]||(t[3]=(...e)=>a.transformFile&&a.transformFile(...e))},"TRANSFORM",2),(0,l._)("a",{class:(0,p.C_)(["btn mt-3",[""===this.download_workbook?"disabled btn-secondary":"btn-success"]]),onClick:t[4]||(t[4]=(...e)=>a.downloadFile&&a.downloadFile(...e))},"DOWNLOAD",2)])}n(7658);const z=function(e){let t=e["TASK NUMBER"];return void 0===t?"":(t=t.replaceAll("\n",""),t)},J=function(e){let t=e["SKILL CODE"];return void 0===t?"":t.substring(0,3)},ee=function(e){let t=e["SOURCE"];return void 0===t?"":t.toUpperCase().match(/5|8|CMR|ALI|FAL/)?"O":"N"},te=function(e){let t=e["SOURCE"];return void 0===t?"":t.toUpperCase().match(/\*|ALI|FAL|CMR/)?"N":"Y"},ne=function(e){return e.toUpperCase().match(/TCC/)?"N":e.toUpperCase().match(/NT/)?"Y":'"to be filled"'},ie=function(e){let t=e["SOURCE"];if(void 0===t)return"";if(t.match(/\*\*/)){const e=["9","8","7","6","5"].filter((e=>t.match(e)));return e.length>0?e[0]+"**":"**"}if(t.match(/\*/)){const e=["9","8","7","6","5"].filter((e=>t.match(e)));return e.length>1?e[1]+e[0]+"*":e.length>0?e[0]+"*":"*"}if(t.match(/FAL/))return"FAL";if(t.match(/ALI/))return"ALI";if(t.match(/9|8|7|6|5/)){const e=["9","8","7","6","5"].filter((e=>t.match(e)));return e.length>2?e[2]+e[1]+e[0]:e.length>1?e[1]+e[0]:e[0]}return t.match(/MRB/)?"MRB":t.match(/CMP/)?"CMP":t.match(/LUR/)?"LUR":t.match(/SEMR/)?"SEM":t.match(/CPCP/)?"CPC":t.match(/VSB/)?"VSB":void 0},le=function(e){let t=e["TASK CODE"];return void 0===t?"":t.toUpperCase().substring(0,3)},oe=function(e,t=!1,n="default"){let i;return"default"===n?i=t?e["SAMPLE THRESHOLD"]:e["100% THRESHOLD"]:"FH"===n?i=t?e["SAMPLE THRESHOLD FH"]:e["100% THRESHOLD FH"]:"FC"===n&&(i=t?e["SAMPLE THRESHOLD FC"]:e["100% THRESHOLD FC"]),void 0===i?"":i.match(/FH/)?"FH":""},re=function(e,t=!1,n="default"){let i;if("default"===n?i=t?e["SAMPLE THRESHOLD"]:e["100% THRESHOLD"]:"FH"===n?i=t?e["SAMPLE THRESHOLD FH"]:e["100% THRESHOLD FH"]:"FC"===n&&(i=t?e["SAMPLE THRESHOLD FC"]:e["100% THRESHOLD FC"]),void 0===i)return"";let l=i.split("OR"),o=l.filter((e=>e.match(/FH/)));if(0==o.length)return"";let r=o[0].replaceAll("\n","").split(" ")[0];return r.length>6?r.substring(0,6):r},ae=function(e,t=!1,n="default"){let i;return"default"===n?i=t?e["SAMPLE THRESHOLD"]:e["100% THRESHOLD"]:"FH"===n?i=t?e["SAMPLE THRESHOLD FH"]:e["100% THRESHOLD FH"]:"FC"===n&&(i=t?e["SAMPLE THRESHOLD FC"]:e["100% THRESHOLD FC"]),void 0===i?"":i.match(/FC/)?"CY":""},Ee=function(e,t=!1,n="default"){let i;if("default"===n?i=t?e["SAMPLE THRESHOLD"]:e["100% THRESHOLD"]:"FH"===n?i=t?e["SAMPLE THRESHOLD FH"]:e["100% THRESHOLD FH"]:"FC"===n&&(i=t?e["SAMPLE THRESHOLD FC"]:e["100% THRESHOLD FC"]),void 0===i)return"";let l=i.split("OR"),o=l.filter((e=>e.match(/FC/)));if(0==o.length)return"";let r=o[0].replaceAll("\n","").split(" ")[0];return r.length>6?r.substring(0,6):r},se=function(e,t=!1,n="default"){let i;return"default"===n?i=t?e["SAMPLE THRESHOLD"]:e["100% THRESHOLD"]:"FH"===n?i=t?e["SAMPLE THRESHOLD FH"]:e["100% THRESHOLD FH"]:"FC"===n&&(i=t?e["SAMPLE THRESHOLD FC"]:e["100% THRESHOLD FC"]),void 0===i?"":i.match(/MO/)?"MO":i.match(/YE/)?"YE":i.match(/DY/)?"DY":""},ce=function(e,t=!1,n="default"){let i;if("default"===n?i=t?e["SAMPLE THRESHOLD"]:e["100% THRESHOLD"]:"FH"===n?i=t?e["SAMPLE THRESHOLD FH"]:e["100% THRESHOLD FH"]:"FC"===n&&(i=t?e["SAMPLE THRESHOLD FC"]:e["100% THRESHOLD FC"]),void 0===i)return"";let l=i.split("OR"),o=l.filter((e=>e.match(/MO|YE|DY/)));if(0==o.length)return"";let r=o[0].replaceAll("\n","").split(" ")[0];return r.length>6?r.substring(0,6):r},ue=function(e,t=!1,n="default"){let i;if("default"===n?i=t?e["SAMPLE INTERVAL"]:e["100% INTERVAL"]:"FH"===n?i=t?e["SAMPLE INTERVAL FH"]:e["100% INTERVAL FH"]:"FC"===n&&(i=t?e["SAMPLE INTERVAL FC"]:e["100% INTERVAL FC"]),void 0===i)return"";let l=i.split("OR"),o=l.filter((e=>e.match(/FH/)));if(0==o.length)return"";let r=o[0].replaceAll("\n","").split(" ")[0];return r.length>6?r.substring(0,6):r},de=function(e,t=!1,n="default"){let i;if("default"===n?i=t?e["SAMPLE INTERVAL"]:e["100% INTERVAL"]:"FH"===n?i=t?e["SAMPLE INTERVAL FH"]:e["100% INTERVAL FH"]:"FC"===n&&(i=t?e["SAMPLE INTERVAL FC"]:e["100% INTERVAL FC"]),void 0===i)return"";let l=i.split("OR"),o=l.filter((e=>e.match(/FC/)));if(0==o.length)return"";let r=o[0].replaceAll("\n","").split(" ")[0];return r.length>6?r.substring(0,6):r},Ae=function(e,t=!1,n="default"){let i;return"default"===n?i=t?e["SAMPLE INTERVAL"]:e["100% INTERVAL"]:"FH"===n?i=t?e["SAMPLE INTERVAL FH"]:e["100% INTERVAL FH"]:"FC"===n&&(i=t?e["SAMPLE INTERVAL FC"]:e["100% INTERVAL FC"]),void 0===i?"":i.match(/MO/)?"MO":i.match(/YE/)?"YE":i.match(/DY/)?"DY":""},Te=function(e,t=!1,n="default"){let i;if("default"===n?i=t?e["SAMPLE INTERVAL"]:e["100% INTERVAL"]:"FH"===n?i=t?e["SAMPLE INTERVAL FH"]:e["100% INTERVAL FH"]:"FC"===n&&(i=t?e["SAMPLE INTERVAL FC"]:e["100% INTERVAL FC"]),void 0===i)return"";let l=i.split("OR"),o=l.filter((e=>e.match(/MO|YE|DY/)));if(0==o.length)return"";let r=o[0].replaceAll("\n","").split(" ")[0];return r.length>6?r.substring(0,6):r},pe=function(e,t="default"){const n=e["TCI"];if(void 0!==n&&n.match(/T/))return"TCC";let i,l;return"default"===t?i=e["100% THRESHOLD"]:"FH"===t?i=e["100% THRESHOLD FH"]:"FC"===t&&(i=e["100% THRESHOLD FC"]),"default"===t?l=e["100% INTERVAL"]:"FH"===t?l=e["100% INTERVAL FH"]:"FC"===t&&(l=e["100% INTERVAL FC"]),void 0!==i&&i.match(/^4 C/)||void 0!==l&&l.match(/^4 C/)?"4C":void 0!==i&&i.match(/NOTE/)&&i.match(/FH|FC|DY|YE|MO/)||void 0!==l&&l.match(/NOTE/)&&l.match(/FH|FC|DY|YE|MO/)?"NT":'"To be filled"'},Re=function(e){let t=e["ZONE"];if(void 0===t)return"";let n=t.split("\n");n=n.filter((e=>0!==e.trim().length));while(n.length<22)n.push("");return n},fe=function(e){let t=e["ACCESS"];if(void 0===t)return"";t=t.replaceAll("\n"," ");let n=t.split(" ").filter((e=>""!=e));if(n.length>=50)return n.slice(0,50);while(n.length<50)n.push("");return n},Ce=function(e){let t=e["TASKM.H."];return void 0===t||t.match(/N\/A|TBC/)||""==t?"":t.split("\n")[0].replaceAll(".",",")},he=function(e){let t=e["MEN"];return void 0===t?"":t.split("\n")[0]},me=function(e){let t=e["DESCRIPTION"];if(void 0===t)return"";let n=t.split("\n")[0];while(n.length>40)n=n.split(" ").slice(0,-1).join(" ");return n.toUpperCase()},Le=function(e){let t=e["DESCRIPTION"],n=e["PREPARATION"],i=e["APPLICABILITY"];if(""!==n&&(t+="\nPREPARATION\n"+n),""!==i&&(t+="\nEFFECTIVITY\n"+i),void 0===t)return"";t=t.replaceAll("\\","");let l=t.split("\n").filter(((e,t)=>""!=e&&0!==t));for(let r=0;r<l.length;r++)if(l[r].length>75){let e=l[r].split(" ");l=[...l.slice(0,r),e.slice(0,Math.round(e.length/2)).join(" "),e.slice(Math.round(e.length/2)).join(" "),...l.slice(r+1)],r=0}if(16==l.length)return l;if(l.length<16){while(l.length<16)l.push("");return l}l=[""];let o=t.split("\n").join(" ").replaceAll("  "," ").replaceAll("  "," ").split(" ");for(let r of o)l[l.length-1].length+r.length+1<=75?l[l.length-1]+=`${r} `:(l[l.length-1]=l[l.length-1].trim(),l.push(`${r} `));if(16==l.length)return l;if(l.length<16){while(l.length<16)l.push("");return l}return l.slice(0,16)},Se=function(e){let t=e["TASK NUMBER"];return void 0===t?"":t.substring(0,2)},Ne=function(e){const t=e["REFERENCE"],n=e["SOURCE TASK REFERENCE"];let i;if((void 0===t||""===t)&&(void 0===n||""===n))return["","","","","","","","","",""];i=void 0===t||""===t?n.split("\n"):void 0===n||""===n?t.split("\n"):[...t.split("\n"),...n.split("\n")];let l=i.filter((e=>0!==e.trim().length)).reduce(((e,n,i)=>{if(i>4)return e;{const l=n.split(" ");return 1===l.length?0===i&&void 0!==t&&""!==t?[...e,l[0],"AMM"]:[...e,l[0],"unknown"]:2===l.length?[...e,l[1],l[0]]:n.match(/APX|APPENDIX/)?[...e,n,"MPD"]:[...e,l.slice(1).join(" "),l[0]]}}),[]);while(l.length<10)l.push("");return l},Oe=function(e){return Object.values(e.slice(0,1)[0]).map((e=>e.toLowerCase())).filter((e=>e.includes("revision")))[0].split("\n")[0].split(":")[1].trim()},Ie=function(e){const t=Object.values(e.slice(0,1)[0]).map((e=>e.toLowerCase())).filter((e=>e.includes("revision")))[0].split("\n")[1].split(":")[1].trim();let n;switch(t.split(" ")[0]){case"jan":n="01";break;case"feb":n="02";break;case"mar":n="03";break;case"apr":n="04";break;case"may":n="05";break;case"jun":n="06";break;case"jul":n="07";break;case"aug":n="08";break;case"sep":n="09";break;case"oct":n="10";break;case"nov":n="11";break;case"dic":n="12";break;default:n="to-be-specifyed"}const i=t.split("/")[0].split(" ")[1],l=2==t.split("/")[1].length?"20"+t.split("/")[1]:t.split("/")[1];return i+"/"+n+"/"+l},Me=function(e){let t=e["REV CODE"];return void 0===t?"":t},ge=function(e,t){let n="",i=e["ZONE"];if(void 0!==i){let e=i.split("\n");e.length>22&&(n+="(more than 22 zones)")}let l=e["ACCESS"];if(void 0!==l){l=l.replaceAll("\n"," ");let e=l.split(" ").filter((e=>""!=e));e.length>50&&(n+="(more than 50 access)")}const o=e["REFERENCE"],r=e["SOURCE TASK REFERENCE"];let a;void 0!==o&&""!==o&&void 0!==r&&""!==r?a=[...o.split("\n"),...r.split("\n")]:void 0===o||""===o?a=r.split("\n"):void 0!==r&&""!==r||(a=o.split("\n")),a.length>5&&(n+="(more than 5 references)");const E=t?["SAMPLE THRESHOLD","SAMPLE INTERVAL","100% THRESHOLD","100% INTERVAL","SAMPLE THRESHOLD FH","SAMPLE INTERVAL FH","100% THRESHOLD FH","100% INTERVAL FH","SAMPLE THRESHOLD FC","SAMPLE INTERVAL FC","100% THRESHOLD FC","100% INTERVAL FC"]:["SAMPLE THRESHOLD","SAMPLE INTERVAL","100% THRESHOLD","100% INTERVAL"];return E.forEach((t=>{const i=e[t];i&&i.includes("CRR")&&(n+=`(CRR in "${t}")`)})),n},De=n(7092);var ve={name:"MPDTransformation",data(){return{aircraftModel:"320",workbook:"",download_workbook:"",numRevisionValue:"",dateRevisionValue:""}},computed:{optimized(){return"330"===this.aircraftModel}},methods:{readFile(){const e=document.querySelectorAll("input")[2];this.file=e.files[0];const t=new FileReader;return t.onload=e=>{const t=e.target.result,n=De.read(t,{type:"binary"});this.workbook=n},t.readAsBinaryString(this.file)},transformFile(){this.optimized?this.transformFileOptimized():this.transformFileNormal()},transformFileNormal(){const e=this.workbook.Sheets["MPD"],t=De.utils.sheet_to_json(e,{header:["REV CODE","SECTION","TASK NUMBER","SOURCE TASK REFERENCE","ACCESS","PREPARATION","ZONE","DESCRIPTION","SKILL CODE","TASK CODE","SAMPLE THRESHOLD","SAMPLE INTERVAL","100% THRESHOLD","100% INTERVAL","SOURCE","TCI","RSC","TPS","REFERENCE","MEN","TASKM.H.","ACCESSM.H.","PREP.M.H.","APPLICABILITY"]});this.numRevisionValue="R"+Oe(t),this.dateRevisionValue=Ie(t);let n=t.slice(2),i=[];n.forEach((e=>{i.push({"REFERENCE DE LA CARTE":z(e),"TYPE DE LA CARTE":"MC",SPECIALITE:J(e),CONTROLE:ee(e),REPORT:te(e),"OUT OF PHASE":ne(pe(e)),PHASE:"",POSTE:"",MRB:ie(e),"CODE TACHE":le(e),NOTE:320===this.aircraftModel?'"to be filled"':"N","TEXT NOTE 1":"","TEXT NOTE 2":"","TEXT NOTE 3":"","COMPTEUR SEUIL 1":oe(e),"VALEUR SEUIL 1":re(e),"COMPTEUR SEUIL 2":ae(e),"VALEUR SEUIL 2":Ee(e),"COMPTEUR SEUIL 3":se(e),"VALEUR SEUIL 3":ce(e),HEURES:ue(e),CYCLES:de(e),"CODE CAL":Ae(e),CALENDAIRE:Te(e),"CODE CHECK":pe(e),"CODE ATYPIQUE 1":"","INTERVAL ATYPIQUE 1":"","CODE ATYPIQUE 2":"","INTERVAL ATYPIQUE 2":"","CODE ATYPIQUE 3":"","INTERVAL ATYPIQUE 3":"","TOLERANCE - TOLERANCE":"N","TOLERANCE - NAME":"","TOLERANCE - HEURES":"","TOLERANCE-CYCLES":"","TOLERANCE - CALENDAIRE":"","TOLERANCE - COD CALENDAIRE":"","TOLERANCE - CPT1":"","TOLERANCE - CPT2":"","TOLERANCE - CPT3":"","METHOD CALC CALENDAIRE":"","METHOD CALC AUTRES":"",...Re(e).reduce(((e,t,n)=>(e[`A/C ZONE ${n+1}`]=t,e)),{}),...fe(e).reduce(((e,t,n)=>(e[`ACCESS ${n+1}`]=t,e)),{}),"FAMILLE MSN 1":"","FAMILLE MSN 2":"","FAMILLE MSN 3":"","FAMILLE MSN 4":"","FAMILLE MSN 5":"",RESSOURCE:J(e),"CHARGE HH":Ce(e),NOMBRE:he(e),"RESSOURCE 2":"","CHARGE HH 2":"","NOMBRE 2":"","RESSOURCE 3":"","CHARGE HH 3":"","NOMBRE 3":"","LIBELLE DE LA CARTE":me(e),...Le(e).reduce(((e,t,n)=>(e[`TEXTE ${n+1}`]=t,e)),{}),ATA:Se(e),"LIBELLE DE L'ATA":"",...Ne(e).reduce(((e,t,n)=>(n%2===0?e["REFERENCE DOCUMENT LIE "+(n+1-n/2)]=t:e["TYPE DOCUMENT LIE "+(n+1)/2]=t,e)),{}),"NUMERO AMENDEMENT":'"to be filled"',"DATE AMENDEMENT":'"to be filled"',"NUMERO REVISION":this.numRevisionValue,"DATE REVISION":this.dateRevisionValue,"TYPE DE MODIFICATION":Me(e),COMMENTS:ge(e,this.optimized)}),(void 0!==e["SAMPLE THRESHOLD"]&&""!==e["SAMPLE THRESHOLD"]||void 0!==e["SAMPLE INTERVAL"]&&""!==e["SAMPLE INTERVAL"])&&i.push({"REFERENCE DE LA CARTE":z(e)+"S","TYPE DE LA CARTE":"MC",SPECIALITE:J(e),CONTROLE:ee(e),REPORT:te(e),"OUT OF PHASE":ne(pe(e)),PHASE:"",POSTE:"",MRB:ie(e),"CODE TACHE":le(e),NOTE:320===this.aircraftModel?'"to be filled"':"N","TEXT NOTE 1":"","TEXT NOTE 2":"","TEXT NOTE 3":"","COMPTEUR SEUIL 1":oe(e,!0),"VALEUR SEUIL 1":re(e,!0),"COMPTEUR SEUIL 2":ae(e,!0),"VALEUR SEUIL 2":Ee(e,!0),"COMPTEUR SEUIL 3":se(e,!0),"VALEUR SEUIL 3":ce(e,!0),HEURES:ue(e,!0),CYCLES:de(e,!0),"CODE CAL":Ae(e,!0),CALENDAIRE:Te(e,!0),"CODE CHECK":pe(e),"CODE ATYPIQUE 1":"","INTERVAL ATYPIQUE 1":"","CODE ATYPIQUE 2":"","INTERVAL ATYPIQUE 2":"","CODE ATYPIQUE 3":"","INTERVAL ATYPIQUE 3":"","TOLERANCE - TOLERANCE":"N","TOLERANCE - NAME":"","TOLERANCE - HEURES":"","TOLERANCE-CYCLES":"","TOLERANCE - CALENDAIRE":"","TOLERANCE - COD CALENDAIRE":"","TOLERANCE - CPT1":"","TOLERANCE - CPT2":"","TOLERANCE - CPT3":"","METHOD CALC CALENDAIRE":"","METHOD CALC AUTRES":"",...Re(e).reduce(((e,t,n)=>(e[`A/C ZONE ${n+1}`]=t,e)),{}),...fe(e).reduce(((e,t,n)=>(e[`ACCESS ${n+1}`]=t,e)),{}),"FAMILLE MSN 1":"","FAMILLE MSN 2":"","FAMILLE MSN 3":"","FAMILLE MSN 4":"","FAMILLE MSN 5":"",RESSOURCE:J(e),"CHARGE HH":Ce(e),NOMBRE:he(e),"RESSOURCE 2":"","CHARGE HH 2":"","NOMBRE 2":"","RESSOURCE 3":"","CHARGE HH 3":"","NOMBRE 3":"","LIBELLE DE LA CARTE":me(e),...Le(e).reduce(((e,t,n)=>(e[`TEXTE ${n+1}`]=t,e)),{}),ATA:Se(e),"LIBELLE DE L'ATA":"",...Ne(e).reduce(((e,t,n)=>(n%2===0?e["REFERENCE DOCUMENT LIE "+(n+1-n/2)]=t:e["TYPE DOCUMENT LIE "+(n+1)/2]=t,e)),{}),"NUMERO AMENDEMENT":'"to be filled"',"DATE AMENDEMENT":'"to be filled"',"NUMERO REVISION":this.numRevisionValue,"DATE REVISION":this.dateRevisionValue,"TYPE DE MODIFICATION":Me(e),COMMENTS:ge(e,this.optimized)})}));const l=De.utils.json_to_sheet(i);this.download_workbook=De.utils.book_new(),this.download_workbook.SheetNames.push("MPD induction AMASIS"),this.download_workbook.Sheets["MPD induction AMASIS"]=l},transformFileOptimized(){const e=this.workbook.Sheets["MPD"],t=De.utils.sheet_to_json(e,{header:["REV CODE","SECTION","TASK NUMBER","SOURCE TASK REFERENCE","ACCESS","PREPARATION","ZONE","DESCRIPTION","SKILL CODE","TASK CODE","SAMPLE THRESHOLD","SAMPLE INTERVAL","100% THRESHOLD","100% INTERVAL","SAMPLE THRESHOLD FH","SAMPLE INTERVAL FH","100% THRESHOLD FH","100% INTERVAL FH","SAMPLE THRESHOLD FC","SAMPLE INTERVAL FC","100% THRESHOLD FC","100% INTERVAL FC","SOURCE","TCI","RSC","TPS","REFERENCE","MEN","TASKM.H.","ACCESSM.H.","PREP.M.H.","APPLICABILITY"]});this.numRevisionValue="R"+Oe(t),this.dateRevisionValue=Ie(t);let n=t.slice(3),i=[[],[],[]];n.forEach((e=>{["FH","FC"].forEach(((t,n)=>{let l;l=void 0!==e[`100% THRESHOLD ${t}`]&&""!==e[`100% THRESHOLD ${t}`]||void 0!==e[`100% INTERVAL ${t}`]&&""!==e[`100% INTERVAL ${t}`]?t:"default",i[n].push({"REFERENCE DE LA CARTE":z(e),"TYPE DE LA CARTE":"MC",SPECIALITE:J(e),CONTROLE:ee(e),REPORT:te(e),"OUT OF PHASE":ne(pe(e,l)),PHASE:"",POSTE:"",MRB:ie(e),"CODE TACHE":le(e),NOTE:320===this.aircraftModel?'"to be filled"':"N","TEXT NOTE 1":"","TEXT NOTE 2":"","TEXT NOTE 3":"","COMPTEUR SEUIL 1":oe(e,!1,l),"VALEUR SEUIL 1":re(e,!1,l),"COMPTEUR SEUIL 2":ae(e,!1,l),"VALEUR SEUIL 2":Ee(e,!1,l),"COMPTEUR SEUIL 3":se(e,!1,l),"VALEUR SEUIL 3":ce(e,!1,l),HEURES:ue(e,!1,l),CYCLES:de(e,!1,l),"CODE CAL":Ae(e,!1,l),CALENDAIRE:Te(e,!1,l),"CODE CHECK":pe(e,l),"CODE ATYPIQUE 1":"","INTERVAL ATYPIQUE 1":"","CODE ATYPIQUE 2":"","INTERVAL ATYPIQUE 2":"","CODE ATYPIQUE 3":"","INTERVAL ATYPIQUE 3":"","TOLERANCE - TOLERANCE":"N","TOLERANCE - NAME":"","TOLERANCE - HEURES":"","TOLERANCE-CYCLES":"","TOLERANCE - CALENDAIRE":"","TOLERANCE - COD CALENDAIRE":"","TOLERANCE - CPT1":"","TOLERANCE - CPT2":"","TOLERANCE - CPT3":"","METHOD CALC CALENDAIRE":"","METHOD CALC AUTRES":"",...Re(e).reduce(((e,t,n)=>(e[`A/C ZONE ${n+1}`]=t,e)),{}),...fe(e).reduce(((e,t,n)=>(e[`ACCESS ${n+1}`]=t,e)),{}),"FAMILLE MSN 1":"","FAMILLE MSN 2":"","FAMILLE MSN 3":"","FAMILLE MSN 4":"","FAMILLE MSN 5":"",RESSOURCE:J(e),"CHARGE HH":Ce(e),NOMBRE:he(e),"RESSOURCE 2":"","CHARGE HH 2":"","NOMBRE 2":"","RESSOURCE 3":"","CHARGE HH 3":"","NOMBRE 3":"","LIBELLE DE LA CARTE":me(e),...Le(e).reduce(((e,t,n)=>(e[`TEXTE ${n+1}`]=t,e)),{}),ATA:Se(e),"LIBELLE DE L'ATA":"",...Ne(e).reduce(((e,t,n)=>(n%2===0?e["REFERENCE DOCUMENT LIE "+(n+1-n/2)]=t:e["TYPE DOCUMENT LIE "+(n+1)/2]=t,e)),{}),"NUMERO AMENDEMENT":'"to be filled"',"DATE AMENDEMENT":'"to be filled"',"NUMERO REVISION":this.numRevisionValue,"DATE REVISION":this.dateRevisionValue,"TYPE DE MODIFICATION":Me(e),COMMENTS:ge(e,this.optimized)}),(void 0!==e["SAMPLE THRESHOLD"+("default"===l?"":` ${l}`)]&&""!==e["SAMPLE THRESHOLD"+("default"===l?"":` ${l}`)]||void 0!==e["SAMPLE INTERVAL"+("default"===l?"":` ${l}`)]&&""!==e["SAMPLE INTERVAL"+("default"===l?"":` ${l}`)])&&i[n].push({"REFERENCE DE LA CARTE":z(e)+"S","TYPE DE LA CARTE":"MC",SPECIALITE:J(e),CONTROLE:ee(e),REPORT:te(e),"OUT OF PHASE":ne(pe(e,l)),PHASE:"",POSTE:"",MRB:ie(e),"CODE TACHE":le(e),NOTE:320===this.aircraftModel?'"to be filled"':"N","TEXT NOTE 1":"","TEXT NOTE 2":"","TEXT NOTE 3":"","COMPTEUR SEUIL 1":oe(e,!0,l),"VALEUR SEUIL 1":re(e,!0,l),"COMPTEUR SEUIL 2":ae(e,!0,l),"VALEUR SEUIL 2":Ee(e,!0,l),"COMPTEUR SEUIL 3":se(e,!0,l),"VALEUR SEUIL 3":ce(e,!0,l),HEURES:ue(e,!0,l),CYCLES:de(e,!0,l),"CODE CAL":Ae(e,!0,l),CALENDAIRE:Te(e,!0,l),"CODE CHECK":pe(e,l),"CODE ATYPIQUE 1":"","INTERVAL ATYPIQUE 1":"","CODE ATYPIQUE 2":"","INTERVAL ATYPIQUE 2":"","CODE ATYPIQUE 3":"","INTERVAL ATYPIQUE 3":"","TOLERANCE - TOLERANCE":"N","TOLERANCE - NAME":"","TOLERANCE - HEURES":"","TOLERANCE-CYCLES":"","TOLERANCE - CALENDAIRE":"","TOLERANCE - COD CALENDAIRE":"","TOLERANCE - CPT1":"","TOLERANCE - CPT2":"","TOLERANCE - CPT3":"","METHOD CALC CALENDAIRE":"","METHOD CALC AUTRES":"",...Re(e).reduce(((e,t,n)=>(e[`A/C ZONE ${n+1}`]=t,e)),{}),...fe(e).reduce(((e,t,n)=>(e[`ACCESS ${n+1}`]=t,e)),{}),"FAMILLE MSN 1":"","FAMILLE MSN 2":"","FAMILLE MSN 3":"","FAMILLE MSN 4":"","FAMILLE MSN 5":"",RESSOURCE:J(e),"CHARGE HH":Ce(e),NOMBRE:he(e),"RESSOURCE 2":"","CHARGE HH 2":"","NOMBRE 2":"","RESSOURCE 3":"","CHARGE HH 3":"","NOMBRE 3":"","LIBELLE DE LA CARTE":me(e),...Le(e).reduce(((e,t,n)=>(e[`TEXTE ${n+1}`]=t,e)),{}),ATA:Se(e),"LIBELLE DE L'ATA":"",...Ne(e).reduce(((e,t,n)=>(n%2===0?e["REFERENCE DOCUMENT LIE "+(n+1-n/2)]=t:e["TYPE DOCUMENT LIE "+(n+1)/2]=t,e)),{}),"NUMERO AMENDEMENT":'"to be filled"',"DATE AMENDEMENT":'"to be filled"',"NUMERO REVISION":this.numRevisionValue,"DATE REVISION":this.dateRevisionValue,"TYPE DE MODIFICATION":Me(e),COMMENTS:ge(e,this.optimized)})}))}));const l=De.utils.json_to_sheet(i[0]),o=De.utils.json_to_sheet(i[1]);this.download_workbook=De.utils.book_new(),this.download_workbook.SheetNames.push("MPD FH induction AMASIS"),this.download_workbook.Sheets["MPD FH induction AMASIS"]=l,this.download_workbook.SheetNames.push("MPD FC induction AMASIS"),this.download_workbook.Sheets["MPD FC induction AMASIS"]=o},downloadFile(){let e="file";De.writeFile(this.download_workbook,`${e}.xlsx`)}},watch:{optimized(){this.download_workbook=""},workbook(){this.download_workbook=""}}};const He=(0,s.Z)(ve,[["render",W],["__scopeId","data-v-39c369d7"]]);var Pe=He;const be=e=>((0,l.dD)("data-v-57b66b92"),e=e(),(0,l.Cn)(),e),Fe={class:"d-flex flex-column"},Ue={class:"inputs-container"},we={class:"input-element"},Ve=be((()=>(0,l._)("label",{for:"mp-edition"}," MP edition: ",-1))),ke=be((()=>(0,l._)("span",{class:"icon icon-16 icon-info","data-toggle":"tooltip","data-placement":"right",title:"'Num√©ro Amendement' value for AMASIS excel column"},null,-1))),_e={class:"input-element"},ye=be((()=>(0,l._)("label",{for:"mp-edition-date"}," MP edition date: ",-1))),Ye=be((()=>(0,l._)("span",{class:"icon icon-16 icon-info","data-toggle":"tooltip","data-placement":"right",title:"'Date Amendement' value for AMASIS excel column"},null,-1))),xe={class:"input-element"},Be=be((()=>(0,l._)("label",{for:"mpd-revision-value"}," MPD revision value: ",-1))),Ke=be((()=>(0,l._)("span",{class:"icon icon-16 icon-info","data-toggle":"tooltip","data-placement":"right",title:"'Num√©ro R√©vision' value for AMASIS excel column"},null,-1))),je={class:"input-element"},Qe=be((()=>(0,l._)("label",{for:"mpd-revision-date"}," MPD revision date: ",-1))),$e=be((()=>(0,l._)("span",{class:"icon icon-16 icon-info","data-toggle":"tooltip","data-placement":"right",title:"'Date R√©vision' value for AMASIS excel column"},null,-1)));function Ze(e,t,n,o,r,a){return(0,l.wg)(),(0,l.iD)("div",Fe,[(0,l._)("div",Ue,[(0,l._)("div",we,[Ve,(0,l.wy)((0,l._)("input",{id:"mp-edition",type:"text","onUpdate:modelValue":t[0]||(t[0]=e=>r.mpEdition=e)},null,512),[[i.nr,r.mpEdition]]),ke]),(0,l._)("div",_e,[ye,(0,l.wy)((0,l._)("input",{id:"mp-edition-date",type:"text","onUpdate:modelValue":t[1]||(t[1]=e=>r.mpEditionDate=e)},null,512),[[i.nr,r.mpEditionDate]]),Ye]),(0,l._)("div",xe,[Be,(0,l.wy)((0,l._)("input",{id:"mpd-revision-value",type:"text","onUpdate:modelValue":t[2]||(t[2]=e=>r.mpdRevisionValue=e)},null,512),[[i.nr,r.mpdRevisionValue]]),Ke]),(0,l._)("div",je,[Qe,(0,l.wy)((0,l._)("input",{id:"mpd-revision-date",type:"text","onUpdate:modelValue":t[3]||(t[3]=e=>r.mpdRevisionDate=e)},null,512),[[i.nr,r.mpdRevisionDate]]),$e])]),(0,l._)("input",{id:"file-input-atr",class:"form-control mt-4",type:"file",accept:".csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel",onChange:t[4]||(t[4]=(...e)=>a.readFile&&a.readFile(...e))},null,32),(0,l._)("button",{class:(0,p.C_)(["btn btn-primary mt-3",[this.allInfoReady?"disabled":""]]),onClick:t[5]||(t[5]=(...e)=>a.transformFile&&a.transformFile(...e))},"TRANSFORM",2),(0,l._)("a",{class:(0,p.C_)(["btn mt-3",[""===this.download_workbook?"disabled btn-secondary":"btn-success"]]),onClick:t[6]||(t[6]=(...e)=>a.downloadFile&&a.downloadFile(...e))},"DOWNLOAD",2)])}function qe(e){const t=e["TASK REFERENCE"];return void 0===t?"":t.replaceAll(/\r|\n/g,"").trim()}function Xe(e){return"MC"}function Ge(e){return e["SKILL"].replaceAll(/\r|\n/g,"")}function We(e){return e["SOURCES"].toLowerCase().includes("cmr")||e["SOURCES"].toLowerCase().includes("awl")?"I":"N"}function ze(e){return e["SOURCES"].toLowerCase().includes("cmr")||e["SOURCES"].toLowerCase().includes("awl")?"N":"Y"}function Je(e){return"to be filled"===e?e:0===e.trim().length?"Y":"N"}function et(e){const t=e["SOURCES"];return t?t.includes("CMR")?"CMR":t.includes("AWL")?"AWL":t.includes("AD")?"AD":t.includes("MRBR")?"MRBR":t.includes("LUR")?"LUR":t.includes("CPCP")?"CPCP":0===t.trim().length?"":t.split(":")[0].replaceAll(/[\(\)]/g,"").trim():""}function tt(e){return"to be filled"}function nt(e){const t={code:"",value:""},n=e["THRESHOLD/INTERVAL/SAMPLE"].replaceAll(/\r/g,"");if(n&&(n.includes("T:")||n.includes("T :"))){const e=n.split("\n"),i=e.filter((e=>(e.includes("T:")||e.includes("T :"))&&e.includes("FH")))[0];i&&i.trim().length>0&&(t.code="FH",t.value=i.split(":")[1].trim().split(" ")[0].trim())}return t}function it(e){const t={code:"",value:""},n=e["THRESHOLD/INTERVAL/SAMPLE"].replaceAll(/\r/g,"");if(n&&(n.includes("T:")||n.includes("T :"))){const e=n.split("\n"),i=e.filter((e=>(e.includes("T:")||e.includes("T :"))&&(e.includes("FC")||e.includes("LD"))))[0];i&&i.trim().length>0&&(t.code="FC",t.value=i.split(":")[1].trim().split(" ")[0].trim())}return t}function lt(e){const t=["YE","MO","DY"],n={code:"",value:""},i=e["THRESHOLD/INTERVAL/SAMPLE"].replaceAll(/\r/g,"");if(i&&(i.includes("T:")||i.includes("T :"))){const e=i.split("\n"),l=e.filter((e=>(e.includes("T:")||e.includes("T :"))&&t.map((t=>e.includes(t))).filter((e=>1==e)).length>0))[0];l&&l.trim().length>0&&(n.code=l.split(":")[1].trim().split(" ")[1].trim(),n.value=l.split(":")[1].trim().split(" ")[0].trim())}return n}function ot(e){const t=8e3,n=750;let i="";const l=e["THRESHOLD/INTERVAL/SAMPLE"].replaceAll(/\r/g,"");if(l&&(l.includes("I:")||l.includes("I :"))){const e=l.split("\n"),o=e.filter((e=>(e.includes("I:")||e.includes("I :"))&&e.includes("FH")))[0];o&&o.trim().length>0&&(i=o.split(":")[1].trim().split(" ")[0].trim());const r=e.filter((e=>(e.includes("I:")||e.includes("I :"))&&e.includes(" C")))[0];if(r&&r.trim().length>0){const e=r.split("I: ").filter((e=>e.length>0))[0].split(" ").filter((e=>e.length>0))[0];"C"==e?i=1*t:isNaN(Number(e))||(i=Number(e)*t)}const a=e.filter((e=>(e.includes("I:")||e.includes("I :"))&&e.includes(" A")))[0];if(a&&a.trim().length>0){const e=a.split("I: ").filter((e=>e.length>0))[0].split(" ").filter((e=>e.length>0))[0];"A"==e?i=1*n:isNaN(Number(e))||(i=Number(e)*n)}}return String(i)}function rt(e){let t="";const n=e["THRESHOLD/INTERVAL/SAMPLE"].replaceAll(/\r/g,"");if(n&&(n.includes("I:")||n.includes("I :"))){const e=n.split("\n"),i=e.filter((e=>(e.includes("I:")||e.includes("I :"))&&(e.includes("FC")||e.includes("LD"))))[0];i&&i.trim().length>0&&(t=i.split(":")[1].trim().split(" ")[0].trim())}return t}function at(e){const t=["YE","MO","DY"],n={code:"",value:""},i=e["THRESHOLD/INTERVAL/SAMPLE"].replaceAll(/\r/g,"");if(i&&(i.includes("I:")||i.includes("I :"))){const e=i.split("\n"),l=e.filter((e=>(e.includes("I:")||e.includes("I :"))&&t.map((t=>e.includes(t))).filter((e=>1==e)).length>0))[0];l&&l.trim().length>0&&(1==l.split(":")[1].trim().split(" ").length?(n.code=l.split(":")[1].trim().split(" ")[0].trim(),n.value="1"):(n.code=l.split(":")[1].trim().split(" ")[1].trim(),n.value=l.split(":")[1].trim().split(" ")[0].trim()))}const l=e["SOURCES"].replaceAll(/\r/g,"");if(l&&l.includes("LUR")){const e=l.trim().split("\n").filter((e=>e.includes("LUR")));let t;e.length>0&&(t=e[0].replaceAll(/\(|\)/g,"").split(":")[1].split("=")[1].split(" ")[0].trim()),["YE","MO","DY"].forEach((e=>{t.includes(e)&&(n.code=e,n.value=t.replace(e,""))}))}return n}function Et(e){const t=!!(e["EQUIPMENT"]&&e["EQUIPMENT"].replaceAll(/\r|\n/g,"").trim().length>0);if(t)return"TCC";let n="";const i=e["THRESHOLD/INTERVAL/SAMPLE"].replaceAll(/\r/g,""),l=e["SOURCES"].replaceAll(/\r/g,""),o=[" A"," C"," WY"];if(l&&l.includes("LUR")){const e=l.trim().split("\n").filter((e=>e.includes("LUR")));if(e.length>0&&e[0].includes("or NR"))return"to be filled"}if(i&&(i.includes("I:")||i.includes("I :"))){const e=i.split("\n");let t=e.filter((e=>(e.includes("I:")||e.includes("I :"))&&e.includes("NR")))[0];if(t&&t.trim().length>0)return"to be filled";t=e.filter((e=>(e.includes("I:")||e.includes("I :"))&&o.map((t=>e.includes(t))).filter((e=>1==e)).length>0)),1==t.length?n=t[0].split(":")[1].replaceAll(/\s/g,"").trim():t.length>1&&(n="to be filled")}return n}function st(e){const t=e["ZONE"];if(void 0===t)return"";const n=t.replaceAll(/\r/g,"").split("\n").filter((e=>0!==e.trim().length));while(n.length<22)n.push("");return n}function ct(e){const t=e["ACCESS"];if(void 0===t)return"";const n=t.replaceAll(/\r/g,"").split("\n").filter((e=>0!==e.trim().length));while(n.length<50)n.push("");return n}function ut(e){const t=e["SKILL"];return void 0===t?"":t.replaceAll(/\r|\n/g,"").trim()}function dt(e){const t=e["MH/ZONE"];return void 0===t?"":t.replaceAll(/\r/g,"").split("\n")[0].trim()}function At(e){const t=e["MAN"];return void 0===t?"":t.replaceAll(/\r/g,"").split("\n")[0].trim()}function Tt(e){let t=e["TITLE"],n=!1;if(void 0===t)return["",n];t=t.replaceAll(/\r/g,"").replaceAll(/\n/g," ").trim();while(t.length>40){n=!0;const e=t.split(" ");t=e.slice(0,e.length-1).join(" ")}return[t,n]}function pt(e){const t=e.split(" ").reduce(((e,t)=>(e[e.length-1]+" "+t).trim().length<76?[...e.slice(0,e.length-1),(e[e.length-1]+" "+t).trim()]:[...e,t]),[""]);return t}function Rt(e){const t=[];return e.forEach((e=>{if(e.trim().length<=75)t.push(e.trim());else{const n=e.trim().split(" ").filter((e=>0!==e.length));let i="";n.forEach(((e,l)=>{(0===i.length?0:i.length+1)+e.length<=75?i+=(0===i.length?"":" ")+e:(t.push(i),i=e),0!==i.length&&l+1===n.length&&t.push(i)}))}})),t}function ft(e){let t=e["DESCRIPTION"],n=e["PREPARATION DESCRIPTION"],i=e["EFFECTIVITY"];if(void 0===t){const e=[];while(e.length<16)e.push("");return e}t=t.replaceAll(/\r/g,"").trim(),n=n.replaceAll(/\r/g,"").trim(),i=i.replaceAll(/\r/g,"").trim();let l=Rt(t.split("\n").filter((e=>0!=e.length))),o=Rt(n.split("\n").filter((e=>0!=e.length))),r=Rt(i.split("\n").filter((e=>0!=e.length)));if(l.length+o.length+r.length<=14){let e=[...l,o!=[""]&&0!==o.length?"PREPARATION:":"",...o,r!=[""]&&0!==r.length?"EFFECTIVITY:":"",...r].filter((e=>0!==e.length));while(e.length<16)e.push("");return e}if(t=t.replaceAll(/\r/g,"").replaceAll(/\n/g," ").trim(),n=n.replaceAll(/\r/g,"").replaceAll(/\n/g," ").trim(),i=i.replaceAll(/\r/g,"").replaceAll(/\n/g," ").trim(),l=pt(t),o=pt(n),r=pt(i),l.length+o.length+r.length<=14){let e=[...l,o!=[""]?"PREPARATION:":"",...o,r!=[""]?"EFFECTIVITY:":"",...r].filter((e=>0!==e.length));while(e.length<16)e.push("");return e}if(o=pt("PREPARATION: "+n),r=pt("EFFECTIVITY: "+i),l.length+o.length+r.length<=16){let e=[...l,...o,...r];while(e.length<16)e.push("");return e}const a=t+" PREPARATION: "+n+" EFFECTIVITY: "+i,E=pt(a);if(16===E.length)return E;while(E.length<16)E.push("");return E}function Ct(e){const t=e["TASK REFERENCE"];return void 0===t?"":t.replaceAll(/\r|\n/g,"").trim().slice(0,2)}function ht(e,t,n,i){e.forEach((e=>{e.includes(t)&&n.push({reference:["MP","ESP"].includes(t)?e.trim().split(t+":").filter((e=>0!=e.length))[0].trim():["MPD","CPCP"].includes(t)?"MPD"==t?i:"":e.replaceAll(/\(|\)/g,"").trim().split(t+" :").filter((e=>0!=e.length))[0].trim(),type:t})}))}function mt(e){const t=e["JOB PROCEDURE"],n=e["SOURCES"];let i=e["TASK REFERENCE"];if(void 0===n)return[{reference:"",type:""},{reference:"",type:""},{reference:"",type:""},{reference:"",type:""},{reference:"",type:""}];i&&(i=i.replaceAll(/\r|\n|\s/g,""));const l=[],o=t.replaceAll(/\r/g,"").split("\n").filter((e=>0!==e.length)),r=n.replaceAll(/\r/g,"").split("\n").filter((e=>0!==e.length));["MP","ESP"].forEach((e=>{ht(o,e,l,i)})),["CMR","AWL","AD","MRBR","LUR","CPCP","CDCCL","MPD"].forEach((e=>{ht(r,e,l,i)})),o.forEach((e=>{const t=e.trim().split(":"),n=t[0].trim(),i=t[1].trim();["MP","ESP"].includes(n)||l.push({reference:i,type:n})}));while(l.length<5)l.push({reference:"",type:""});return l}function Lt(e){const t=e["REV CODE"];return void 0===t?"":t.replaceAll(/\r|\n/g,"")}function St(e,t,n,i,l){let o="";return e.length>22&&(o+="(more than 22 zones)"),t.length>50&&(o+="(more than 50 acces)"),n[1]&&(o+="(title with more than 50 characters)"),i.length>16&&(o+="(more than 16 cells for text)"),l.length>5&&(o+="(more than 5 documents linked)"),o}function Nt(e,t){const n=[];return e.forEach((e=>{const i=nt(e),l=it(e),o=lt(e),r=at(e),a=Et(e),E=st(e),s=ct(e),c=Tt(e),u=ft(e),d=mt(e),A={"R√©f√©rence de la Carte":qe(e),"Type de la Carte":Xe(e),"Sp√©cialit√©":Ge(e),"Contr√¥le":We(e),Report:ze(e),"Out of Phase":Je(a),Phase:"",Poste:"","Cat√©gorie MRB":et(e),"Code Tache":tt(e),Note:"","Texte de la Note 1":"","Texte de la Note 2":"","Texte de la Note 3":"","Code Seuil 1":i.code,"Seuil 1":i.value,"Code Seuil 2":l.code,"Seuil 2":l.value,"Code Seuil 3":o.code,"Seuil 3":o.value,Heures:ot(e),Cycles:rt(e),"Code Cal.":r.code,Calendaire:r.value,"Code Check":a,"Code Atypique 1":"","Intervalle Atypique 1":"","Code Atypique 2":"","Intervalle Atypique 2":"","Code Atypique 3":"","Intervalle Atypique 3":"","Tol√©rance - Tol√©rance":"","Tol√©rance - Name":"","Tol√©rance - Heures":"","Tol√©rance - Cycles":"","Tol√©rance - Calendaire":"","Tol√©rance - Code Calendaire":"","Tol√©rance - CPT1":"","Tol√©rance - CPT2":"","Tol√©rance - CPT3":"","M√©thode de Calcul calendaire":"","M√©thode de Calcul autres":"",...E.reduce(((e,t,n)=>(Object.keys(e).length<22&&(e[`A/C ZONE ${n+1}`]=t),e)),{}),...s.reduce(((e,t,n)=>(Object.keys(e).length<50&&(e[`ACCES ${n+1}`]=t),e)),{}),"Famille MSN 1":"","Famille MSN 2":"","Famille MSN 3":"","Famille MSN 4":"","Famille MSN 5":"","Ressource (Qualification) 1":ut(e),"Charge H.h 1":dt(e),"Nombre 1":At(e),"Ressource (Qualification) 2":"","Charge H.h 2":"","Nombre 2":"","Ressource (Qualification) 3":"","Charge H.h 3":"","Nombre 3":"","Libell√© de la Carte":c[0],...u.reduce(((e,t,n)=>(Object.keys(e).length<16&&(e[`Text Ligne ${n+1}`]=t),e)),{}),ATA:Ct(e),"Libell√© de l'ATA (optionnel)":"","R√©f√©rence document li√© 1":d[0].reference,"Type de Document 1":d[0].type,"R√©f√©rence document li√© 2":d[1].reference,"Type de Document 2":d[1].type,"R√©f√©rence document li√© 3":d[2].reference,"Type de Document 3":d[2].type,"R√©f√©rence document li√© 4":d[3].reference,"Type de Document 4":d[3].type,"R√©f√©rence document li√© 5":d[4].reference,"Type de Document 5":d[4].type,"Num√©ro Amendement":t["mpEdition"],"Date Amendement":t["mpEditionDate"],"Num√©ro R√©vision":t["mpdRevisionValue"],"Date R√©vision":t["mpdRevisionDate"],"Type de modification":Lt(e),Comments:St(E,s,c,u,d)};n.push(A)})),n}const Ot=n(7092);var It={name:"MPDTransformationATR",data(){return{workbook:"",download_workbook:"",mpEdition:"",mpEditionDate:"",mpdRevisionValue:"",mpdRevisionDate:""}},computed:{allInfoReady(){return""===this.workbook||""===this.mpEdition||""===this.mpEditionDate||""===this.mpdRevisionValue||""===this.mpdRevisionDate},allVariablesAffectingDownload(){return[this.workbook,this.mpEdition,this.mpEditionDate,this.mpdRevisionValue,this.mpdRevisionDate]}},methods:{readFile(){const e=document.querySelector("#file-input-atr");this.file=e.files[0];const t=new FileReader;return t.onload=e=>{const t=e.target.result,n=Ot.read(t,{type:"binary"});this.workbook=n},t.readAsBinaryString(this.file)},transformFile(){this.transformFileNormal()},transformFileNormal(){const e=this.workbook.Sheets["MPDTasks"],t=Ot.utils.sheet_to_json(e,{header:["REV CODE","TASK REFERENCE","TITLE","DESCRIPTION","SECTION","THRESHOLD/INTERVAL/SAMPLE","SOURCES","EFFECTIVITY","JOB PROCEDURE","ZONE","MH/ZONE","MAN","ACCESS","MH/ACCESS","PREPARATION DESCRIPTION","MH/PREPARATION","SKILL","EQUIPMENT"]});let n=t.slice(2);const i={mpEdition:this.mpEdition,mpEditionDate:this.mpEditionDate,mpdRevisionValue:this.mpdRevisionValue,mpdRevisionDate:this.mpdRevisionDate},l=Nt(n,i),o=Ot.utils.json_to_sheet(l);this.download_workbook=Ot.utils.book_new(),this.download_workbook.SheetNames.push("MPD induction AMASIS"),this.download_workbook.Sheets["MPD induction AMASIS"]=o},downloadFile(){let e="file";Ot.writeFile(this.download_workbook,`${e}.xlsx`)}},watch:{allVariablesAffectingDownload(){this.download_workbook=""}},mounted(){}};const Mt=(0,s.Z)(It,[["render",Ze],["__scopeId","data-v-57b66b92"]]);var gt=Mt;const Dt=e=>((0,l.dD)("data-v-587f0f04"),e=e(),(0,l.Cn)(),e),vt={class:"d-flex flex-column"},Ht={class:"inputs-container"},Pt={class:"input-element"},bt=Dt((()=>(0,l._)("label",{for:"mp-edition"}," MP edition: ",-1))),Ft=Dt((()=>(0,l._)("span",{class:"icon icon-16 icon-info","data-toggle":"tooltip","data-placement":"right",title:"'Num√©ro Amendement' value for AMASIS excel column"},null,-1))),Ut={class:"input-element"},wt=Dt((()=>(0,l._)("label",{for:"mp-edition-date"}," MP edition date: ",-1))),Vt=Dt((()=>(0,l._)("span",{class:"icon icon-16 icon-info","data-toggle":"tooltip","data-placement":"right",title:"'Date Amendement' value for AMASIS excel column"},null,-1))),kt={class:"input-element"},_t=Dt((()=>(0,l._)("label",{for:"mpd-revision-value"}," MPD revision value: ",-1))),yt=Dt((()=>(0,l._)("span",{class:"icon icon-16 icon-info","data-toggle":"tooltip","data-placement":"right",title:"'Num√©ro R√©vision' value for AMASIS excel column"},null,-1))),Yt={class:"input-element"},xt=Dt((()=>(0,l._)("label",{for:"mpd-revision-date"}," MPD revision date: ",-1))),Bt=Dt((()=>(0,l._)("span",{class:"icon icon-16 icon-info","data-toggle":"tooltip","data-placement":"right",title:"'Date R√©vision' value for AMASIS excel column"},null,-1)));function Kt(e,t,n,o,r,a){return(0,l.wg)(),(0,l.iD)("div",vt,[(0,l._)("div",Ht,[(0,l._)("div",Pt,[bt,(0,l.wy)((0,l._)("input",{id:"mp-edition",type:"text","onUpdate:modelValue":t[0]||(t[0]=e=>r.mpEdition=e)},null,512),[[i.nr,r.mpEdition]]),Ft]),(0,l._)("div",Ut,[wt,(0,l.wy)((0,l._)("input",{id:"mp-edition-date",type:"text","onUpdate:modelValue":t[1]||(t[1]=e=>r.mpEditionDate=e)},null,512),[[i.nr,r.mpEditionDate]]),Vt]),(0,l._)("div",kt,[_t,(0,l.wy)((0,l._)("input",{id:"mpd-revision-value",type:"text","onUpdate:modelValue":t[2]||(t[2]=e=>r.mpdRevisionValue=e)},null,512),[[i.nr,r.mpdRevisionValue]]),yt]),(0,l._)("div",Yt,[xt,(0,l.wy)((0,l._)("input",{id:"mpd-revision-date",type:"text","onUpdate:modelValue":t[3]||(t[3]=e=>r.mpdRevisionDate=e)},null,512),[[i.nr,r.mpdRevisionDate]]),Bt])]),(0,l._)("input",{id:"file-input-arkia",class:"form-control mt-4",type:"file",accept:".csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel",onChange:t[4]||(t[4]=(...e)=>a.readFile&&a.readFile(...e))},null,32),(0,l._)("button",{class:(0,p.C_)(["btn btn-primary mt-3",[this.allInfoReady?"disabled":""]]),onClick:t[5]||(t[5]=(...e)=>a.transformFile&&a.transformFile(...e))},"TRANSFORM",2),(0,l._)("a",{class:(0,p.C_)(["btn mt-3",[""===this.download_workbook?"disabled btn-secondary":"btn-success"]]),onClick:t[6]||(t[6]=(...e)=>a.downloadFile&&a.downloadFile(...e))},"DOWNLOAD",2)])}function jt(e){const t=e["TASK NUMBER"];return void 0===t?"":t.replaceAll(/\r|\n/g,"").trim()}function Qt(e){const t=e["TASK NUMBER"];return void 0===t?"":"MC"}function $t(e){const t=e["TASK NUMBER"];return void 0===t?"":"MEC"}function Zt(e){const t=e["TASK NUMBER"];return void 0===t?"":"N"}function qt(e){const t=e["TASK NUMBER"];return void 0===t?"":"Y"}function Xt(e){const t=e["OUT OF PHASE"];return void 0===t?"":t.replaceAll(/\r|\n/g,"").trim()}function Gt(e){const t=e["CATEGORIE"];return void 0===t?"":t.replaceAll(/\r|\n/g,"").trim()}function Wt(e){const t=e["TASK"];return void 0===t?"":t.replaceAll(/\r|\n/g,"").trim()}function zt(e){const t=e["TASK NUMBER"];return void 0===t?"":"N"}function Jt(e){const t={code:"",value:""},n=e["THRESHOLD/INTERVAL/SAMPLE"].replaceAll(/\r/g,"");if(n&&(n.includes("T:")||n.includes("T :"))){const e=n.split("\n"),i=e.filter((e=>(e.includes("T:")||e.includes("T :"))&&e.includes("FH")))[0];i&&i.trim().length>0&&(t.code="FH",t.value=i.split(":")[1].trim().split(" ")[0].trim())}return t}function en(e){const t={code:"",value:""},n=e["THRESHOLD/INTERVAL/SAMPLE"].replaceAll(/\r/g,"");if(n&&(n.includes("T:")||n.includes("T :"))){const e=n.split("\n"),i=e.filter((e=>(e.includes("T:")||e.includes("T :"))&&(e.includes("FC")||e.includes("LD"))))[0];i&&i.trim().length>0&&(t.code="FC",t.value=i.split(":")[1].trim().split(" ")[0].trim())}return t}function tn(e){const t=["YE","MO","DY"],n={code:"",value:""},i=e["THRESHOLD/INTERVAL/SAMPLE"].replaceAll(/\r/g,"");if(i&&(i.includes("T:")||i.includes("T :"))){const e=i.split("\n"),l=e.filter((e=>(e.includes("T:")||e.includes("T :"))&&t.map((t=>e.includes(t))).filter((e=>1==e)).length>0))[0];l&&l.trim().length>0&&(n.code=l.split(":")[1].trim().split(" ")[1].trim(),n.value=l.split(":")[1].trim().split(" ")[0].trim())}return n}function nn(e){let t="";const n=e["THRESHOLD/INTERVAL/SAMPLE"].replaceAll(/\r/g,"");if(n&&(n.includes("I:")||n.includes("I :"))){const e=n.split("\n"),i=e.filter((e=>(e.includes("I:")||e.includes("I :"))&&e.includes("FH")))[0];i&&i.trim().length>0&&(t=i.split(":")[1].trim().split(" ")[0].trim())}return String(t)}function ln(e){let t="";const n=e["THRESHOLD/INTERVAL/SAMPLE"].replaceAll(/\r/g,"");if(n&&(n.includes("I:")||n.includes("I :"))){const e=n.split("\n"),i=e.filter((e=>(e.includes("I:")||e.includes("I :"))&&(e.includes("FC")||e.includes("LD"))))[0];i&&i.trim().length>0&&(t=i.split(":")[1].trim().split(" ")[0].trim())}return String(t)}function on(e){const t=["YE","MO","DY"],n={code:"",value:""},i=e["THRESHOLD/INTERVAL/SAMPLE"].replaceAll(/\r/g,"");if(i&&(i.includes("I:")||i.includes("I :"))){const e=i.split("\n"),l=e.filter((e=>(e.includes("I:")||e.includes("I :"))&&t.map((t=>e.includes(t))).filter((e=>1==e)).length>0))[0];l&&l.trim().length>0&&(1==l.split(":")[1].trim().split(" ").length?(n.code=l.split(":")[1].trim().split(" ")[0].trim(),n.value="1"):(n.code=l.split(":")[1].trim().split(" ")[1].trim(),n.value=l.split(":")[1].trim().split(" ")[0].trim()))}return n}function rn(e){const t=e["CODE CHECK"];return void 0===t?"":t.replaceAll(/\r|\n/g,"").trim()}function an(e){const t=e["TASK NUMBER"];return void 0===t?"":"N"}function En(e){const t=e["ZONE"];if(void 0===t)return"";const n=t.replaceAll(/\r/g,"").split("\n").filter((e=>0!==e.trim().length));while(n.length<22)n.push("");return n}function sn(e){const t=e["PANELS"];if(void 0===t)return"";const n=t.replaceAll(/\r/g,"").replaceAll(/,/g,"\n").split("\n").map((e=>e.trim())).filter((e=>0!==e.length));while(n.length<50)n.push("");return n}function cn(e){const t=e["TASK NUMBER"];return void 0===t?"":"MEC"}function un(e){let t=e["TITLE"],n=!1;if(void 0===t)return["",n];t=t.replaceAll(/\r/g,"").replaceAll(/\n/g," ").trim();while(t.length>40){n=!0;const e=t.split(" ");t=e.slice(0,e.length-1).join(" ")}return[t,n]}function dn(e){const t=e.split(" ").reduce(((e,t)=>(e[e.length-1]+" "+t).trim().length<76?[...e.slice(0,e.length-1),(e[e.length-1]+" "+t).trim()]:[...e,t]),[""]);return t}function An(e){const t=[];return e.forEach((e=>{if(e.trim().length<=75)t.push(e.trim());else{const n=e.trim().split(" ").filter((e=>0!==e.length));let i="";n.forEach(((e,l)=>{(0===i.length?0:i.length+1)+e.length<=75?i+=(0===i.length?"":" ")+e:(t.push(i),i=e),0!==i.length&&l+1===n.length&&t.push(i)}))}})),t}function Tn(e){let t=e["DESCRIPTION"],n=e["PREPARATION"];if(void 0===t){const e=[];while(e.length<16)e.push("");return e}t=t.replaceAll(/\r/g,"").trim(),n=n.replaceAll(/\r/g,"").trim();let i=An(t.split("\n").filter((e=>0!=e.length))),l=An(n.split("\n").filter((e=>0!=e.length)));if(i.length+l.length<=14){let e=[...i,l!=[""]&&0!==l.length?"PREPARATION:":"",...l].filter((e=>0!==e.length));while(e.length<16)e.push("");return e}if(t=t.replaceAll(/\r/g,"").replaceAll(/\n/g," ").trim(),n=n.replaceAll(/\r/g,"").replaceAll(/\n/g," ").trim(),i=dn(t),l=dn(n),i.length+l.length<=14){let e=[...i,l!=[""]?"PREPARATION:":"",...l].filter((e=>0!==e.length));while(e.length<16)e.push("");return e}if(l=dn("PREPARATION: "+n),i.length+l.length<=16){let e=[...i,...l];while(e.length<16)e.push("");return e}const o=t+" PREPARATION: "+n,r=dn(o);if(16===r.length)return r;while(r.length<16)r.push("");return r}function pn(e){const t=e["ATA"];return void 0===t?"":t.replaceAll(/\r|\n/g,"").trim().slice(0,2)}function Rn(e){const t=e["REFERENCE"];if(void 0===t)return[{reference:"",type:""},{reference:"",type:""},{reference:"",type:""},{reference:"",type:""},{reference:"",type:""}];const n=[],i=t.replaceAll(/\r/g,"").replaceAll(/:\n/g,": ").split("\n").filter((e=>0!==e.length&&!e.includes("-----")));if(i){const e=[["AD"],["EAD"],["ICAO","EAS"],["FAA"],["IANR","IAN"],["SBE"],["CMP"],["AMM"],["ICA"],["MPD"],["MPD-S","MPD"],["AMM-S","AMM"],["EO"],["TAR"]];e.forEach((e=>{i.forEach(((t,l)=>{if(t.includes(": ")){if(t.includes(e[0]+": ")){const i=t.split(": ");n.push({reference:i[1].trim(),type:1===e.length?e[0]:e[1]})}}else{let o,r=l-1;while(r>0&&void 0===o)i[r].includes(": ")&&(o=i[r].split(": ")[0]),r--;o&&o.includes(e[0])&&n.push({reference:t.trim(),type:1===e.length?e[0]:e[1]})}}))}))}while(n.length<5)n.push({reference:"",type:""});return n}function fn(e){const t=e["REV"];return void 0===t?"":t.replaceAll(/\r|\n/g,"")}function Cn(e,t,n,i,l){let o="";return e.length>22&&(o+="(more than 22 zones)"),t.length>50&&(o+="(more than 50 acces)"),n[1]&&(o+="(title with more than 50 characters)"),i.length>16&&(o+="(more than 16 cells for text)"),l.length>5&&(o+="(more than 5 documents linked)"),o}function hn(e,t){const n=[];return e.forEach((e=>{const i=Jt(e),l=en(e),o=tn(e),r=on(e),a=rn(e),E=En(e),s=sn(e),c=un(e),u=Tn(e),d=Rn(e),A={"R√©f√©rence de la Carte":jt(e),"Type de la Carte":Qt(e),"Sp√©cialit√©":$t(e),"Contr√¥le":Zt(e),Report:qt(e),"Out of Phase":Xt(e),Phase:"",Poste:"","Cat√©gorie MRB":Gt(e),"Code Tache":Wt(e),Note:zt(e),"Texte de la Note 1":"","Texte de la Note 2":"","Texte de la Note 3":"","Code Seuil 1":i.code,"Seuil 1":i.value,"Code Seuil 2":l.code,"Seuil 2":l.value,"Code Seuil 3":o.code,"Seuil 3":o.value,Heures:nn(e),Cycles:ln(e),"Code Cal.":r.code,Calendaire:r.value,"Code Check":a,"Code Atypique 1":"","Intervalle Atypique 1":"","Code Atypique 2":"","Intervalle Atypique 2":"","Code Atypique 3":"","Intervalle Atypique 3":"","Tol√©rance - Tol√©rance":an(e),"Tol√©rance - Name":"","Tol√©rance - Heures":"","Tol√©rance - Cycles":"","Tol√©rance - Calendaire":"","Tol√©rance - Code Calendaire":"","Tol√©rance - CPT1":"","Tol√©rance - CPT2":"","Tol√©rance - CPT3":"","M√©thode de Calcul calendaire":"","M√©thode de Calcul autres":"",...E.reduce(((e,t,n)=>(Object.keys(e).length<22&&(e[`A/C ZONE ${n+1}`]=t),e)),{}),...s.reduce(((e,t,n)=>(Object.keys(e).length<50&&(e[`ACCES ${n+1}`]=t),e)),{}),"Famille MSN 1":"","Famille MSN 2":"","Famille MSN 3":"","Famille MSN 4":"","Famille MSN 5":"","Ressource (Qualification) 1":cn(e),"Charge H.h 1":"","Nombre 1":"","Ressource (Qualification) 2":"","Charge H.h 2":"","Nombre 2":"","Ressource (Qualification) 3":"","Charge H.h 3":"","Nombre 3":"","Libell√© de la Carte":c[0],...u.reduce(((e,t,n)=>(Object.keys(e).length<16&&(e[`Text Ligne ${n+1}`]=t),e)),{}),ATA:pn(e),"Libell√© de l'ATA (optionnel)":"","R√©f√©rence document li√© 1":d[0].reference,"Type de Document 1":d[0].type,"R√©f√©rence document li√© 2":d[1].reference,"Type de Document 2":d[1].type,"R√©f√©rence document li√© 3":d[2].reference,"Type de Document 3":d[2].type,"R√©f√©rence document li√© 4":d[3].reference,"Type de Document 4":d[3].type,"R√©f√©rence document li√© 5":d[4].reference,"Type de Document 5":d[4].type,"Num√©ro Amendement":t["mpEdition"],"Date Amendement":t["mpEditionDate"],"Num√©ro R√©vision":t["mpdRevisionValue"],"Date R√©vision":t["mpdRevisionDate"],"Type de modification":fn(e),Comments:Cn(E,s,c,u,d)};n.push(A)})),n}const mn=n(7092);var Ln={name:"MPDTransformationATR",data(){return{workbook:"",download_workbook:"",mpEdition:"",mpEditionDate:"",mpdRevisionValue:"",mpdRevisionDate:""}},computed:{allInfoReady(){return""===this.workbook||""===this.mpEdition||""===this.mpEditionDate||""===this.mpdRevisionValue||""===this.mpdRevisionDate},allVariablesAffectingDownload(){return[this.workbook,this.mpEdition,this.mpEditionDate,this.mpdRevisionValue,this.mpdRevisionDate]}},methods:{readFile(){const e=document.querySelector("#file-input-arkia");this.file=e.files[0];const t=new FileReader;return t.onload=e=>{const t=e.target.result,n=mn.read(t,{type:"binary"});this.workbook=n},t.readAsBinaryString(this.file)},transformFile(){this.transformFileNormal()},transformFileNormal(){const e=this.workbook.Sheets[this.workbook.SheetNames[0]],t=mn.utils.sheet_to_json(e,{header:["SECTION","REV","TASK NUMBER","ATA","ZONE","TYPE CARTE","SPECIALITE","CONTROLE","REPORT","PANELS","TITLE","DESCRIPTION","NOTE (I)","NOTE (T)","NOTE (M)","TASK NOTE","PREPARATION","TASK","NOTE","THRESHOLD/INTERVAL/SAMPLE","CODE CHECK","OUT OF PHASE","TOLERANCE","SOURCE","CATEGORIE","REFERENCE","EFFECTIVITY","CLASS","CLASS. COMMENT","Item Rev. Date","REASON"]});let n=t.slice(3);const i={mpEdition:this.mpEdition,mpEditionDate:this.mpEditionDate,mpdRevisionValue:this.mpdRevisionValue,mpdRevisionDate:this.mpdRevisionDate},l=hn(n,i),o=mn.utils.json_to_sheet(l);this.download_workbook=mn.utils.book_new(),this.download_workbook.SheetNames.push("MPD induction AMASIS"),this.download_workbook.Sheets["MPD induction AMASIS"]=o},downloadFile(){let e="file";mn.writeFile(this.download_workbook,`${e}.xlsx`)}},watch:{allVariablesAffectingDownload(){this.download_workbook=""}},mounted(){}};const Sn=(0,s.Z)(Ln,[["render",Kt],["__scopeId","data-v-587f0f04"]]);var Nn=Sn,On={name:"MPDTransformationView",components:{MPDTransformation:Pe,MPDTransformationATR:gt,MPDTransformationArkia:Nn}};const In=(0,s.Z)(On,[["render",K],["__scopeId","data-v-151f0712"]]);var Mn=In;const gn=[{path:"/",name:"home",component:b},{path:"/MPD-transformation",name:"MPD-transformation",component:Mn}],Dn=(0,A.p7)({history:(0,A.r5)(),routes:gn});var vn=Dn,Hn=n(65),Pn=(0,Hn.MT)({state:{},getters:{},mutations:{},actions:{},modules:{}});n(2166);(0,i.ri)(d).use(Pn).use(vn).mount("#app")}},t={};function n(i){var l=t[i];if(void 0!==l)return l.exports;var o=t[i]={exports:{}};return e[i].call(o.exports,o,o.exports,n),o.exports}n.m=e,function(){var e=[];n.O=function(t,i,l,o){if(!i){var r=1/0;for(c=0;c<e.length;c++){i=e[c][0],l=e[c][1],o=e[c][2];for(var a=!0,E=0;E<i.length;E++)(!1&o||r>=o)&&Object.keys(n.O).every((function(e){return n.O[e](i[E])}))?i.splice(E--,1):(a=!1,o<r&&(r=o));if(a){e.splice(c--,1);var s=l();void 0!==s&&(t=s)}}return t}o=o||0;for(var c=e.length;c>0&&e[c-1][2]>o;c--)e[c]=e[c-1];e[c]=[i,l,o]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){n.d=function(e,t){for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){n.p="/mpd-induction/"}(),function(){var e={143:0};n.O.j=function(t){return 0===e[t]};var t=function(t,i){var l,o,r=i[0],a=i[1],E=i[2],s=0;if(r.some((function(t){return 0!==e[t]}))){for(l in a)n.o(a,l)&&(n.m[l]=a[l]);if(E)var c=E(n)}for(t&&t(i);s<r.length;s++)o=r[s],n.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return n.O(c)},i=self["webpackChunkproject"]=self["webpackChunkproject"]||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))}();var i=n.O(void 0,[998],(function(){return n(239)}));i=n.O(i)})();
//# sourceMappingURL=app.3ec69273.js.map