(function(){"use strict";var e={132:function(e,t,n){var l=n(9242),i=n(3396);function E(e,t){const n=(0,i.up)("router-view");return(0,i.wg)(),(0,i.j4)(n)}var r=n(89);const o={},a=(0,r.Z)(o,[["render",E]]);var s=a,c=n(2483);function u(e,t,n,l,E,r){const o=(0,i.up)("home");return(0,i.wg)(),(0,i.iD)("div",null,[(0,i.Wm)(o)])}const d=(0,i._)("h1",null,"HOME",-1),A=(0,i._)("p",null,"This application allows to transform the data related to the MPD from the excel file given by Airbus, to the excel file needed to enter this data with Amasis.",-1),R=(0,i._)("p",null,"To understand be",-1);function T(e,t,n,l,E,r){const o=(0,i.up)("router-link");return(0,i.wg)(),(0,i.iD)("div",null,[d,A,(0,i._)("p",null,[(0,i.Uk)("In order to do that, go to the "),(0,i.Wm)(o,{to:{name:"MPD-transformation"}},{default:(0,i.w5)((()=>[(0,i.Uk)("Application")])),_:1}),(0,i.Uk)(" tab and follow the instructions.")]),R])}var C={name:"Home",mounted(){}};const L=(0,r.Z)(C,[["render",T]]);var S=L,f={name:"HomeView",components:{Home:S}};const p=(0,r.Z)(f,[["render",u]]);var O=p;const h=e=>((0,i.dD)("data-v-3cfa67d0"),e=e(),(0,i.Cn)(),e),N=h((()=>(0,i._)("div",{class:"background"},null,-1))),m={id:"main-container",class:"p-5 text-center border rounded-5 shadow bg-white"},I=h((()=>(0,i._)("h1",{class:"mb-5"},"ðŸš€ MPD INDUCTION APP ðŸš€",-1))),M=h((()=>(0,i._)("p",null,"This application allows to transform the data from the MPD excel, to an excel file with the data structure required to enter it to Amasis.",-1))),H=h((()=>(0,i._)("nav",null,[(0,i._)("div",{class:"nav nav-tabs",id:"nav-tab",role:"tablist"},[(0,i._)("button",{class:"nav-link active",id:"nav-airbus-tab","data-bs-toggle":"tab","data-bs-target":"#nav-airbus",type:"button",role:"tab","aria-controls":"nav-airbus","aria-selected":"true"},"Airbus"),(0,i._)("button",{class:"nav-link",id:"nav-atr-tab","data-bs-toggle":"tab","data-bs-target":"#nav-atr",type:"button",role:"tab","aria-controls":"nav-atr","aria-selected":"false"},"ATR")])],-1))),D={class:"tab-content",id:"nav-tabContent"},P={class:"tab-pane fade show active",id:"nav-airbus",role:"tabpanel","aria-labelledby":"nav-airbus-tab",tabindex:"0"},g={class:"tab-pane fade",id:"nav-atr",role:"tabpanel","aria-labelledby":"nav-atr-tab",tabindex:"0"};function v(e,t,n,l,E,r){const o=(0,i.up)("MPDTransformation"),a=(0,i.up)("MPDTransformationATR");return(0,i.wg)(),(0,i.iD)("div",null,[N,(0,i._)("div",m,[I,M,H,(0,i._)("div",D,[(0,i._)("div",P,[(0,i.Wm)(o)]),(0,i._)("div",g,[(0,i.Wm)(a)])])])])}var F=n(7139);const b=e=>((0,i.dD)("data-v-39c369d7"),e=e(),(0,i.Cn)(),e),U={class:"d-flex flex-column"},V={class:"parameter-container"},w={class:"radio-btn-container"},k=b((()=>(0,i._)("span",null,"Aircraft model:",-1))),_=b((()=>(0,i._)("label",{for:"radio-320"},"320",-1))),Y=b((()=>(0,i._)("label",{for:"radio-330"},"330",-1)));function y(e,t,n,E,r,o){return(0,i.wg)(),(0,i.iD)("div",U,[(0,i._)("div",V,[(0,i._)("div",w,[k,(0,i._)("div",null,[(0,i.wy)((0,i._)("input",{type:"radio",id:"radio-320",name:"aircraft-model",value:"320","onUpdate:modelValue":t[0]||(t[0]=e=>r.aircraftModel=e)},null,512),[[l.G2,r.aircraftModel]]),_]),(0,i._)("div",null,[(0,i.wy)((0,i._)("input",{type:"radio",id:"radio-330",name:"aircraft-model",value:"330","onUpdate:modelValue":t[1]||(t[1]=e=>r.aircraftModel=e)},null,512),[[l.G2,r.aircraftModel]]),Y])])]),(0,i._)("input",{class:"form-control mt-4",type:"file",accept:".csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel",onChange:t[2]||(t[2]=(...e)=>o.readFile&&o.readFile(...e))},null,32),(0,i._)("button",{class:(0,F.C_)(["btn btn-primary mt-3",[""===this.workbook?"disabled":""]]),onClick:t[3]||(t[3]=(...e)=>o.transformFile&&o.transformFile(...e))},"TRANSFORM",2),(0,i._)("a",{class:(0,F.C_)(["btn mt-3",[""===this.download_workbook?"disabled btn-secondary":"btn-success"]]),onClick:t[4]||(t[4]=(...e)=>o.downloadFile&&o.downloadFile(...e))},"DOWNLOAD",2)])}n(7658);const B=function(e){let t=e["TASK NUMBER"];return void 0===t?"":(t=t.replaceAll("\n",""),t)},x=function(e){let t=e["SKILL CODE"];return void 0===t?"":t.substring(0,3)},j=function(e){let t=e["SOURCE"];return void 0===t?"":t.toUpperCase().match(/5|8|CMR|ALI|FAL/)?"O":"N"},Q=function(e){let t=e["SOURCE"];return void 0===t?"":t.toUpperCase().match(/\*|ALI|FAL|CMR/)?"N":"Y"},K=function(e){return e.toUpperCase().match(/TCC/)?"N":e.toUpperCase().match(/NT/)?"Y":'"to be filled"'},$=function(e){let t=e["SOURCE"];if(void 0===t)return"";if(t.match(/\*\*/)){const e=["9","8","7","6","5"].filter((e=>t.match(e)));return e.length>0?e[0]+"**":"**"}if(t.match(/\*/)){const e=["9","8","7","6","5"].filter((e=>t.match(e)));return e.length>1?e[1]+e[0]+"*":e.length>0?e[0]+"*":"*"}if(t.match(/FAL/))return"FAL";if(t.match(/ALI/))return"ALI";if(t.match(/9|8|7|6|5/)){const e=["9","8","7","6","5"].filter((e=>t.match(e)));return e.length>2?e[2]+e[1]+e[0]:e.length>1?e[1]+e[0]:e[0]}return t.match(/MRB/)?"MRB":t.match(/CMP/)?"CMP":t.match(/LUR/)?"LUR":t.match(/SEMR/)?"SEM":t.match(/CPCP/)?"CPC":t.match(/VSB/)?"VSB":void 0},Z=function(e){let t=e["TASK CODE"];return void 0===t?"":t.toUpperCase().substring(0,3)},X=function(e,t=!1,n="default"){let l;return"default"===n?l=t?e["SAMPLE THRESHOLD"]:e["100% THRESHOLD"]:"FH"===n?l=t?e["SAMPLE THRESHOLD FH"]:e["100% THRESHOLD FH"]:"FC"===n&&(l=t?e["SAMPLE THRESHOLD FC"]:e["100% THRESHOLD FC"]),void 0===l?"":l.match(/FH/)?"FH":""},G=function(e,t=!1,n="default"){let l;if("default"===n?l=t?e["SAMPLE THRESHOLD"]:e["100% THRESHOLD"]:"FH"===n?l=t?e["SAMPLE THRESHOLD FH"]:e["100% THRESHOLD FH"]:"FC"===n&&(l=t?e["SAMPLE THRESHOLD FC"]:e["100% THRESHOLD FC"]),void 0===l)return"";let i=l.split("OR"),E=i.filter((e=>e.match(/FH/)));if(0==E.length)return"";let r=E[0].replaceAll("\n","").split(" ")[0];return r.length>6?r.substring(0,6):r},z=function(e,t=!1,n="default"){let l;return"default"===n?l=t?e["SAMPLE THRESHOLD"]:e["100% THRESHOLD"]:"FH"===n?l=t?e["SAMPLE THRESHOLD FH"]:e["100% THRESHOLD FH"]:"FC"===n&&(l=t?e["SAMPLE THRESHOLD FC"]:e["100% THRESHOLD FC"]),void 0===l?"":l.match(/FC/)?"CY":""},W=function(e,t=!1,n="default"){let l;if("default"===n?l=t?e["SAMPLE THRESHOLD"]:e["100% THRESHOLD"]:"FH"===n?l=t?e["SAMPLE THRESHOLD FH"]:e["100% THRESHOLD FH"]:"FC"===n&&(l=t?e["SAMPLE THRESHOLD FC"]:e["100% THRESHOLD FC"]),void 0===l)return"";let i=l.split("OR"),E=i.filter((e=>e.match(/FC/)));if(0==E.length)return"";let r=E[0].replaceAll("\n","").split(" ")[0];return r.length>6?r.substring(0,6):r},q=function(e,t=!1,n="default"){let l;return"default"===n?l=t?e["SAMPLE THRESHOLD"]:e["100% THRESHOLD"]:"FH"===n?l=t?e["SAMPLE THRESHOLD FH"]:e["100% THRESHOLD FH"]:"FC"===n&&(l=t?e["SAMPLE THRESHOLD FC"]:e["100% THRESHOLD FC"]),void 0===l?"":l.match(/MO/)?"MO":l.match(/YE/)?"YE":l.match(/DY/)?"DY":""},J=function(e,t=!1,n="default"){let l;if("default"===n?l=t?e["SAMPLE THRESHOLD"]:e["100% THRESHOLD"]:"FH"===n?l=t?e["SAMPLE THRESHOLD FH"]:e["100% THRESHOLD FH"]:"FC"===n&&(l=t?e["SAMPLE THRESHOLD FC"]:e["100% THRESHOLD FC"]),void 0===l)return"";let i=l.split("OR"),E=i.filter((e=>e.match(/MO|YE|DY/)));if(0==E.length)return"";let r=E[0].replaceAll("\n","").split(" ")[0];return r.length>6?r.substring(0,6):r},ee=function(e,t=!1,n="default"){let l;if("default"===n?l=t?e["SAMPLE INTERVAL"]:e["100% INTERVAL"]:"FH"===n?l=t?e["SAMPLE INTERVAL FH"]:e["100% INTERVAL FH"]:"FC"===n&&(l=t?e["SAMPLE INTERVAL FC"]:e["100% INTERVAL FC"]),void 0===l)return"";let i=l.split("OR"),E=i.filter((e=>e.match(/FH/)));if(0==E.length)return"";let r=E[0].replaceAll("\n","").split(" ")[0];return r.length>6?r.substring(0,6):r},te=function(e,t=!1,n="default"){let l;if("default"===n?l=t?e["SAMPLE INTERVAL"]:e["100% INTERVAL"]:"FH"===n?l=t?e["SAMPLE INTERVAL FH"]:e["100% INTERVAL FH"]:"FC"===n&&(l=t?e["SAMPLE INTERVAL FC"]:e["100% INTERVAL FC"]),void 0===l)return"";let i=l.split("OR"),E=i.filter((e=>e.match(/FC/)));if(0==E.length)return"";let r=E[0].replaceAll("\n","").split(" ")[0];return r.length>6?r.substring(0,6):r},ne=function(e,t=!1,n="default"){let l;return"default"===n?l=t?e["SAMPLE INTERVAL"]:e["100% INTERVAL"]:"FH"===n?l=t?e["SAMPLE INTERVAL FH"]:e["100% INTERVAL FH"]:"FC"===n&&(l=t?e["SAMPLE INTERVAL FC"]:e["100% INTERVAL FC"]),void 0===l?"":l.match(/MO/)?"MO":l.match(/YE/)?"YE":l.match(/DY/)?"DY":""},le=function(e,t=!1,n="default"){let l;if("default"===n?l=t?e["SAMPLE INTERVAL"]:e["100% INTERVAL"]:"FH"===n?l=t?e["SAMPLE INTERVAL FH"]:e["100% INTERVAL FH"]:"FC"===n&&(l=t?e["SAMPLE INTERVAL FC"]:e["100% INTERVAL FC"]),void 0===l)return"";let i=l.split("OR"),E=i.filter((e=>e.match(/MO|YE|DY/)));if(0==E.length)return"";let r=E[0].replaceAll("\n","").split(" ")[0];return r.length>6?r.substring(0,6):r},ie=function(e,t="default"){const n=e["TCI"];if(void 0!==n&&n.match(/T/))return"TCC";let l,i;return"default"===t?l=e["100% THRESHOLD"]:"FH"===t?l=e["100% THRESHOLD FH"]:"FC"===t&&(l=e["100% THRESHOLD FC"]),"default"===t?i=e["100% INTERVAL"]:"FH"===t?i=e["100% INTERVAL FH"]:"FC"===t&&(i=e["100% INTERVAL FC"]),void 0!==l&&l.match(/^4 C/)||void 0!==i&&i.match(/^4 C/)?"4C":void 0!==l&&l.match(/NOTE/)&&l.match(/FH|FC|DY|YE|MO/)||void 0!==i&&i.match(/NOTE/)&&i.match(/FH|FC|DY|YE|MO/)?"NT":'"To be filled"'},Ee=function(e){let t=e["ZONE"];if(void 0===t)return"";let n=t.split("\n");n=n.filter((e=>0!==e.trim().length));while(n.length<22)n.push("");return n},re=function(e){let t=e["ACCESS"];if(void 0===t)return"";t=t.replaceAll("\n"," ");let n=t.split(" ").filter((e=>""!=e));if(n.length>=50)return n.slice(0,50);while(n.length<50)n.push("");return n},oe=function(e){let t=e["TASKM.H."];return void 0===t||t.match(/N\/A|TBC/)||""==t?"":t.split("\n")[0].replaceAll(".",",")},ae=function(e){let t=e["MEN"];return void 0===t?"":t.split("\n")[0]},se=function(e){let t=e["DESCRIPTION"];if(void 0===t)return"";let n=t.split("\n")[0];while(n.length>40)n=n.split(" ").slice(0,-1).join(" ");return n.toUpperCase()},ce=function(e){let t=e["DESCRIPTION"],n=e["PREPARATION"],l=e["APPLICABILITY"];if(""!==n&&(t+="\nPREPARATION\n"+n),""!==l&&(t+="\nEFFECTIVITY\n"+l),void 0===t)return"";t=t.replaceAll("\\","");let i=t.split("\n").filter(((e,t)=>""!=e&&0!==t));for(let r=0;r<i.length;r++)if(i[r].length>75){let e=i[r].split(" ");i=[...i.slice(0,r),e.slice(0,Math.round(e.length/2)).join(" "),e.slice(Math.round(e.length/2)).join(" "),...i.slice(r+1)],r=0}if(16==i.length)return i;if(i.length<16){while(i.length<16)i.push("");return i}i=[""];let E=t.split("\n").join(" ").replaceAll("  "," ").replaceAll("  "," ").split(" ");for(let r of E)i[i.length-1].length+r.length+1<=75?i[i.length-1]+=`${r} `:(i[i.length-1]=i[i.length-1].trim(),i.push(`${r} `));if(16==i.length)return i;if(i.length<16){while(i.length<16)i.push("");return i}return i.slice(0,16)},ue=function(e){let t=e["TASK NUMBER"];return void 0===t?"":t.substring(0,2)},de=function(e){const t=e["REFERENCE"],n=e["SOURCE TASK REFERENCE"];let l;if((void 0===t||""===t)&&(void 0===n||""===n))return["","","","","","","","","",""];l=void 0===t||""===t?n.split("\n"):void 0===n||""===n?t.split("\n"):[...t.split("\n"),...n.split("\n")];let i=l.filter((e=>0!==e.trim().length)).reduce(((e,n,l)=>{if(l>4)return e;{const i=n.split(" ");return 1===i.length?0===l&&void 0!==t&&""!==t?[...e,i[0],"AMM"]:[...e,i[0],"unknown"]:2===i.length?[...e,i[1],i[0]]:n.match(/APX|APPENDIX/)?[...e,n,"MPD"]:[...e,i.slice(1).join(" "),i[0]]}}),[]);while(i.length<10)i.push("");return i},Ae=function(e){return Object.values(e.slice(0,1)[0]).map((e=>e.toLowerCase())).filter((e=>e.includes("revision")))[0].split("\n")[0].split(":")[1].trim()},Re=function(e){const t=Object.values(e.slice(0,1)[0]).map((e=>e.toLowerCase())).filter((e=>e.includes("revision")))[0].split("\n")[1].split(":")[1].trim();let n;switch(t.split(" ")[0]){case"jan":n="01";break;case"feb":n="02";break;case"mar":n="03";break;case"apr":n="04";break;case"may":n="05";break;case"jun":n="06";break;case"jul":n="07";break;case"aug":n="08";break;case"sep":n="09";break;case"oct":n="10";break;case"nov":n="11";break;case"dic":n="12";break;default:n="to-be-specifyed"}const l=t.split("/")[0].split(" ")[1],i=2==t.split("/")[1].length?"20"+t.split("/")[1]:t.split("/")[1];return l+"/"+n+"/"+i},Te=function(e){let t=e["REV CODE"];return void 0===t?"":t},Ce=function(e,t){let n="",l=e["ZONE"];if(void 0!==l){let e=l.split("\n");e.length>22&&(n+="(more than 22 zones)")}let i=e["ACCESS"];if(void 0!==i){i=i.replaceAll("\n"," ");let e=i.split(" ").filter((e=>""!=e));e.length>50&&(n+="(more than 50 access)")}const E=e["REFERENCE"],r=e["SOURCE TASK REFERENCE"];let o;void 0!==E&&""!==E&&void 0!==r&&""!==r?o=[...E.split("\n"),...r.split("\n")]:void 0===E||""===E?o=r.split("\n"):void 0!==r&&""!==r||(o=E.split("\n")),o.length>5&&(n+="(more than 5 references)");const a=t?["SAMPLE THRESHOLD","SAMPLE INTERVAL","100% THRESHOLD","100% INTERVAL","SAMPLE THRESHOLD FH","SAMPLE INTERVAL FH","100% THRESHOLD FH","100% INTERVAL FH","SAMPLE THRESHOLD FC","SAMPLE INTERVAL FC","100% THRESHOLD FC","100% INTERVAL FC"]:["SAMPLE THRESHOLD","SAMPLE INTERVAL","100% THRESHOLD","100% INTERVAL"];return a.forEach((t=>{const l=e[t];l&&l.includes("CRR")&&(n+=`(CRR in "${t}")`)})),n},Le=n(7092);var Se={name:"MPDTransformation",data(){return{aircraftModel:"320",workbook:"",download_workbook:"",numRevisionValue:"",dateRevisionValue:""}},computed:{optimized(){return"330"===this.aircraftModel}},methods:{readFile(){const e=document.querySelectorAll("input")[2];this.file=e.files[0];const t=new FileReader;return t.onload=e=>{const t=e.target.result,n=Le.read(t,{type:"binary"});this.workbook=n},t.readAsBinaryString(this.file)},transformFile(){this.optimized?this.transformFileOptimized():this.transformFileNormal()},transformFileNormal(){const e=this.workbook.Sheets["MPD"],t=Le.utils.sheet_to_json(e,{header:["REV CODE","SECTION","TASK NUMBER","SOURCE TASK REFERENCE","ACCESS","PREPARATION","ZONE","DESCRIPTION","SKILL CODE","TASK CODE","SAMPLE THRESHOLD","SAMPLE INTERVAL","100% THRESHOLD","100% INTERVAL","SOURCE","TCI","RSC","TPS","REFERENCE","MEN","TASKM.H.","ACCESSM.H.","PREP.M.H.","APPLICABILITY"]});this.numRevisionValue="R"+Ae(t),this.dateRevisionValue=Re(t);let n=t.slice(2),l=[];n.forEach((e=>{l.push({"REFERENCE DE LA CARTE":B(e),"TYPE DE LA CARTE":"MC",SPECIALITE:x(e),CONTROLE:j(e),REPORT:Q(e),"OUT OF PHASE":K(ie(e)),PHASE:"",POSTE:"",MRB:$(e),"CODE TACHE":Z(e),NOTE:320===this.aircraftModel?'"to be filled"':"N","TEXT NOTE 1":"","TEXT NOTE 2":"","TEXT NOTE 3":"","COMPTEUR SEUIL 1":X(e),"VALEUR SEUIL 1":G(e),"COMPTEUR SEUIL 2":z(e),"VALEUR SEUIL 2":W(e),"COMPTEUR SEUIL 3":q(e),"VALEUR SEUIL 3":J(e),HEURES:ee(e),CYCLES:te(e),"CODE CAL":ne(e),CALENDAIRE:le(e),"CODE CHECK":ie(e),"CODE ATYPIQUE 1":"","INTERVAL ATYPIQUE 1":"","CODE ATYPIQUE 2":"","INTERVAL ATYPIQUE 2":"","CODE ATYPIQUE 3":"","INTERVAL ATYPIQUE 3":"","TOLERANCE - TOLERANCE":"N","TOLERANCE - NAME":"","TOLERANCE - HEURES":"","TOLERANCE-CYCLES":"","TOLERANCE - CALENDAIRE":"","TOLERANCE - COD CALENDAIRE":"","TOLERANCE - CPT1":"","TOLERANCE - CPT2":"","TOLERANCE - CPT3":"","METHOD CALC CALENDAIRE":"","METHOD CALC AUTRES":"",...Ee(e).reduce(((e,t,n)=>(e[`A/C ZONE ${n+1}`]=t,e)),{}),...re(e).reduce(((e,t,n)=>(e[`ACCESS ${n+1}`]=t,e)),{}),"FAMILLE MSN 1":"","FAMILLE MSN 2":"","FAMILLE MSN 3":"","FAMILLE MSN 4":"","FAMILLE MSN 5":"",RESSOURCE:x(e),"CHARGE HH":oe(e),NOMBRE:ae(e),"RESSOURCE 2":"","CHARGE HH 2":"","NOMBRE 2":"","RESSOURCE 3":"","CHARGE HH 3":"","NOMBRE 3":"","LIBELLE DE LA CARTE":se(e),...ce(e).reduce(((e,t,n)=>(e[`TEXTE ${n+1}`]=t,e)),{}),ATA:ue(e),"LIBELLE DE L'ATA":"",...de(e).reduce(((e,t,n)=>(n%2===0?e["REFERENCE DOCUMENT LIE "+(n+1-n/2)]=t:e["TYPE DOCUMENT LIE "+(n+1)/2]=t,e)),{}),"NUMERO AMENDEMENT":'"to be filled"',"DATE AMENDEMENT":'"to be filled"',"NUMERO REVISION":this.numRevisionValue,"DATE REVISION":this.dateRevisionValue,"TYPE DE MODIFICATION":Te(e),COMMENTS:Ce(e,this.optimized)}),(void 0!==e["SAMPLE THRESHOLD"]&&""!==e["SAMPLE THRESHOLD"]||void 0!==e["SAMPLE INTERVAL"]&&""!==e["SAMPLE INTERVAL"])&&l.push({"REFERENCE DE LA CARTE":B(e)+"S","TYPE DE LA CARTE":"MC",SPECIALITE:x(e),CONTROLE:j(e),REPORT:Q(e),"OUT OF PHASE":K(ie(e)),PHASE:"",POSTE:"",MRB:$(e),"CODE TACHE":Z(e),NOTE:320===this.aircraftModel?'"to be filled"':"N","TEXT NOTE 1":"","TEXT NOTE 2":"","TEXT NOTE 3":"","COMPTEUR SEUIL 1":X(e,!0),"VALEUR SEUIL 1":G(e,!0),"COMPTEUR SEUIL 2":z(e,!0),"VALEUR SEUIL 2":W(e,!0),"COMPTEUR SEUIL 3":q(e,!0),"VALEUR SEUIL 3":J(e,!0),HEURES:ee(e,!0),CYCLES:te(e,!0),"CODE CAL":ne(e,!0),CALENDAIRE:le(e,!0),"CODE CHECK":ie(e),"CODE ATYPIQUE 1":"","INTERVAL ATYPIQUE 1":"","CODE ATYPIQUE 2":"","INTERVAL ATYPIQUE 2":"","CODE ATYPIQUE 3":"","INTERVAL ATYPIQUE 3":"","TOLERANCE - TOLERANCE":"N","TOLERANCE - NAME":"","TOLERANCE - HEURES":"","TOLERANCE-CYCLES":"","TOLERANCE - CALENDAIRE":"","TOLERANCE - COD CALENDAIRE":"","TOLERANCE - CPT1":"","TOLERANCE - CPT2":"","TOLERANCE - CPT3":"","METHOD CALC CALENDAIRE":"","METHOD CALC AUTRES":"",...Ee(e).reduce(((e,t,n)=>(e[`A/C ZONE ${n+1}`]=t,e)),{}),...re(e).reduce(((e,t,n)=>(e[`ACCESS ${n+1}`]=t,e)),{}),"FAMILLE MSN 1":"","FAMILLE MSN 2":"","FAMILLE MSN 3":"","FAMILLE MSN 4":"","FAMILLE MSN 5":"",RESSOURCE:x(e),"CHARGE HH":oe(e),NOMBRE:ae(e),"RESSOURCE 2":"","CHARGE HH 2":"","NOMBRE 2":"","RESSOURCE 3":"","CHARGE HH 3":"","NOMBRE 3":"","LIBELLE DE LA CARTE":se(e),...ce(e).reduce(((e,t,n)=>(e[`TEXTE ${n+1}`]=t,e)),{}),ATA:ue(e),"LIBELLE DE L'ATA":"",...de(e).reduce(((e,t,n)=>(n%2===0?e["REFERENCE DOCUMENT LIE "+(n+1-n/2)]=t:e["TYPE DOCUMENT LIE "+(n+1)/2]=t,e)),{}),"NUMERO AMENDEMENT":'"to be filled"',"DATE AMENDEMENT":'"to be filled"',"NUMERO REVISION":this.numRevisionValue,"DATE REVISION":this.dateRevisionValue,"TYPE DE MODIFICATION":Te(e),COMMENTS:Ce(e,this.optimized)})}));const i=Le.utils.json_to_sheet(l);this.download_workbook=Le.utils.book_new(),this.download_workbook.SheetNames.push("MPD induction AMASIS"),this.download_workbook.Sheets["MPD induction AMASIS"]=i},transformFileOptimized(){const e=this.workbook.Sheets["MPD"],t=Le.utils.sheet_to_json(e,{header:["REV CODE","SECTION","TASK NUMBER","SOURCE TASK REFERENCE","ACCESS","PREPARATION","ZONE","DESCRIPTION","SKILL CODE","TASK CODE","SAMPLE THRESHOLD","SAMPLE INTERVAL","100% THRESHOLD","100% INTERVAL","SAMPLE THRESHOLD FH","SAMPLE INTERVAL FH","100% THRESHOLD FH","100% INTERVAL FH","SAMPLE THRESHOLD FC","SAMPLE INTERVAL FC","100% THRESHOLD FC","100% INTERVAL FC","SOURCE","TCI","RSC","TPS","REFERENCE","MEN","TASKM.H.","ACCESSM.H.","PREP.M.H.","APPLICABILITY"]});this.numRevisionValue="R"+Ae(t),this.dateRevisionValue=Re(t);let n=t.slice(3),l=[[],[],[]];n.forEach((e=>{["FH","FC"].forEach(((t,n)=>{let i;i=void 0!==e[`100% THRESHOLD ${t}`]&&""!==e[`100% THRESHOLD ${t}`]||void 0!==e[`100% INTERVAL ${t}`]&&""!==e[`100% INTERVAL ${t}`]?t:"default",l[n].push({"REFERENCE DE LA CARTE":B(e),"TYPE DE LA CARTE":"MC",SPECIALITE:x(e),CONTROLE:j(e),REPORT:Q(e),"OUT OF PHASE":K(ie(e,i)),PHASE:"",POSTE:"",MRB:$(e),"CODE TACHE":Z(e),NOTE:320===this.aircraftModel?'"to be filled"':"N","TEXT NOTE 1":"","TEXT NOTE 2":"","TEXT NOTE 3":"","COMPTEUR SEUIL 1":X(e,!1,i),"VALEUR SEUIL 1":G(e,!1,i),"COMPTEUR SEUIL 2":z(e,!1,i),"VALEUR SEUIL 2":W(e,!1,i),"COMPTEUR SEUIL 3":q(e,!1,i),"VALEUR SEUIL 3":J(e,!1,i),HEURES:ee(e,!1,i),CYCLES:te(e,!1,i),"CODE CAL":ne(e,!1,i),CALENDAIRE:le(e,!1,i),"CODE CHECK":ie(e,i),"CODE ATYPIQUE 1":"","INTERVAL ATYPIQUE 1":"","CODE ATYPIQUE 2":"","INTERVAL ATYPIQUE 2":"","CODE ATYPIQUE 3":"","INTERVAL ATYPIQUE 3":"","TOLERANCE - TOLERANCE":"N","TOLERANCE - NAME":"","TOLERANCE - HEURES":"","TOLERANCE-CYCLES":"","TOLERANCE - CALENDAIRE":"","TOLERANCE - COD CALENDAIRE":"","TOLERANCE - CPT1":"","TOLERANCE - CPT2":"","TOLERANCE - CPT3":"","METHOD CALC CALENDAIRE":"","METHOD CALC AUTRES":"",...Ee(e).reduce(((e,t,n)=>(e[`A/C ZONE ${n+1}`]=t,e)),{}),...re(e).reduce(((e,t,n)=>(e[`ACCESS ${n+1}`]=t,e)),{}),"FAMILLE MSN 1":"","FAMILLE MSN 2":"","FAMILLE MSN 3":"","FAMILLE MSN 4":"","FAMILLE MSN 5":"",RESSOURCE:x(e),"CHARGE HH":oe(e),NOMBRE:ae(e),"RESSOURCE 2":"","CHARGE HH 2":"","NOMBRE 2":"","RESSOURCE 3":"","CHARGE HH 3":"","NOMBRE 3":"","LIBELLE DE LA CARTE":se(e),...ce(e).reduce(((e,t,n)=>(e[`TEXTE ${n+1}`]=t,e)),{}),ATA:ue(e),"LIBELLE DE L'ATA":"",...de(e).reduce(((e,t,n)=>(n%2===0?e["REFERENCE DOCUMENT LIE "+(n+1-n/2)]=t:e["TYPE DOCUMENT LIE "+(n+1)/2]=t,e)),{}),"NUMERO AMENDEMENT":'"to be filled"',"DATE AMENDEMENT":'"to be filled"',"NUMERO REVISION":this.numRevisionValue,"DATE REVISION":this.dateRevisionValue,"TYPE DE MODIFICATION":Te(e),COMMENTS:Ce(e,this.optimized)}),(void 0!==e["SAMPLE THRESHOLD"+("default"===i?"":` ${i}`)]&&""!==e["SAMPLE THRESHOLD"+("default"===i?"":` ${i}`)]||void 0!==e["SAMPLE INTERVAL"+("default"===i?"":` ${i}`)]&&""!==e["SAMPLE INTERVAL"+("default"===i?"":` ${i}`)])&&l[n].push({"REFERENCE DE LA CARTE":B(e)+"S","TYPE DE LA CARTE":"MC",SPECIALITE:x(e),CONTROLE:j(e),REPORT:Q(e),"OUT OF PHASE":K(ie(e,i)),PHASE:"",POSTE:"",MRB:$(e),"CODE TACHE":Z(e),NOTE:320===this.aircraftModel?'"to be filled"':"N","TEXT NOTE 1":"","TEXT NOTE 2":"","TEXT NOTE 3":"","COMPTEUR SEUIL 1":X(e,!0,i),"VALEUR SEUIL 1":G(e,!0,i),"COMPTEUR SEUIL 2":z(e,!0,i),"VALEUR SEUIL 2":W(e,!0,i),"COMPTEUR SEUIL 3":q(e,!0,i),"VALEUR SEUIL 3":J(e,!0,i),HEURES:ee(e,!0,i),CYCLES:te(e,!0,i),"CODE CAL":ne(e,!0,i),CALENDAIRE:le(e,!0,i),"CODE CHECK":ie(e,i),"CODE ATYPIQUE 1":"","INTERVAL ATYPIQUE 1":"","CODE ATYPIQUE 2":"","INTERVAL ATYPIQUE 2":"","CODE ATYPIQUE 3":"","INTERVAL ATYPIQUE 3":"","TOLERANCE - TOLERANCE":"N","TOLERANCE - NAME":"","TOLERANCE - HEURES":"","TOLERANCE-CYCLES":"","TOLERANCE - CALENDAIRE":"","TOLERANCE - COD CALENDAIRE":"","TOLERANCE - CPT1":"","TOLERANCE - CPT2":"","TOLERANCE - CPT3":"","METHOD CALC CALENDAIRE":"","METHOD CALC AUTRES":"",...Ee(e).reduce(((e,t,n)=>(e[`A/C ZONE ${n+1}`]=t,e)),{}),...re(e).reduce(((e,t,n)=>(e[`ACCESS ${n+1}`]=t,e)),{}),"FAMILLE MSN 1":"","FAMILLE MSN 2":"","FAMILLE MSN 3":"","FAMILLE MSN 4":"","FAMILLE MSN 5":"",RESSOURCE:x(e),"CHARGE HH":oe(e),NOMBRE:ae(e),"RESSOURCE 2":"","CHARGE HH 2":"","NOMBRE 2":"","RESSOURCE 3":"","CHARGE HH 3":"","NOMBRE 3":"","LIBELLE DE LA CARTE":se(e),...ce(e).reduce(((e,t,n)=>(e[`TEXTE ${n+1}`]=t,e)),{}),ATA:ue(e),"LIBELLE DE L'ATA":"",...de(e).reduce(((e,t,n)=>(n%2===0?e["REFERENCE DOCUMENT LIE "+(n+1-n/2)]=t:e["TYPE DOCUMENT LIE "+(n+1)/2]=t,e)),{}),"NUMERO AMENDEMENT":'"to be filled"',"DATE AMENDEMENT":'"to be filled"',"NUMERO REVISION":this.numRevisionValue,"DATE REVISION":this.dateRevisionValue,"TYPE DE MODIFICATION":Te(e),COMMENTS:Ce(e,this.optimized)})}))}));const i=Le.utils.json_to_sheet(l[0]),E=Le.utils.json_to_sheet(l[1]);this.download_workbook=Le.utils.book_new(),this.download_workbook.SheetNames.push("MPD FH induction AMASIS"),this.download_workbook.Sheets["MPD FH induction AMASIS"]=i,this.download_workbook.SheetNames.push("MPD FC induction AMASIS"),this.download_workbook.Sheets["MPD FC induction AMASIS"]=E},downloadFile(){let e="file";Le.writeFile(this.download_workbook,`${e}.xlsx`)}},watch:{optimized(){this.download_workbook=""},workbook(){this.download_workbook=""}}};const fe=(0,r.Z)(Se,[["render",y],["__scopeId","data-v-39c369d7"]]);var pe=fe;const Oe=e=>((0,i.dD)("data-v-68770c52"),e=e(),(0,i.Cn)(),e),he={class:"d-flex flex-column"},Ne={class:"inputs-container"},me={class:"input-element"},Ie=Oe((()=>(0,i._)("label",{for:"mp-edition"}," MP edition: ",-1))),Me=Oe((()=>(0,i._)("span",{class:"icon icon-16 icon-info","data-toggle":"tooltip","data-placement":"right",title:"'NumÃ©ro Amendement' value for AMASIS excel column"},null,-1))),He={class:"input-element"},De=Oe((()=>(0,i._)("label",{for:"mp-edition-date"}," MP edition date: ",-1))),Pe=Oe((()=>(0,i._)("span",{class:"icon icon-16 icon-info","data-toggle":"tooltip","data-placement":"right",title:"'Date Amendement' value for AMASIS excel column"},null,-1))),ge={class:"input-element"},ve=Oe((()=>(0,i._)("label",{for:"mpd-revision-value"}," MPD revision value: ",-1))),Fe=Oe((()=>(0,i._)("span",{class:"icon icon-16 icon-info","data-toggle":"tooltip","data-placement":"right",title:"'NumÃ©ro RÃ©vision' value for AMASIS excel column"},null,-1))),be={class:"input-element"},Ue=Oe((()=>(0,i._)("label",{for:"mpd-revision-date"}," MPD revision date: ",-1))),Ve=Oe((()=>(0,i._)("span",{class:"icon icon-16 icon-info","data-toggle":"tooltip","data-placement":"right",title:"'Date RÃ©vision' value for AMASIS excel column"},null,-1)));function we(e,t,n,E,r,o){return(0,i.wg)(),(0,i.iD)("div",he,[(0,i._)("div",Ne,[(0,i._)("div",me,[Ie,(0,i.wy)((0,i._)("input",{id:"mp-edition",type:"text","onUpdate:modelValue":t[0]||(t[0]=e=>r.mpEdition=e)},null,512),[[l.nr,r.mpEdition]]),Me]),(0,i._)("div",He,[De,(0,i.wy)((0,i._)("input",{id:"mp-edition-date",type:"text","onUpdate:modelValue":t[1]||(t[1]=e=>r.mpEditionDate=e)},null,512),[[l.nr,r.mpEditionDate]]),Pe]),(0,i._)("div",ge,[ve,(0,i.wy)((0,i._)("input",{id:"mpd-revision-value",type:"text","onUpdate:modelValue":t[2]||(t[2]=e=>r.mpdRevisionValue=e)},null,512),[[l.nr,r.mpdRevisionValue]]),Fe]),(0,i._)("div",be,[Ue,(0,i.wy)((0,i._)("input",{id:"mpd-revision-date",type:"text","onUpdate:modelValue":t[3]||(t[3]=e=>r.mpdRevisionDate=e)},null,512),[[l.nr,r.mpdRevisionDate]]),Ve])]),(0,i._)("input",{id:"file-input",class:"form-control mt-4",type:"file",accept:".csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel",onChange:t[4]||(t[4]=(...e)=>o.readFile&&o.readFile(...e))},null,32),(0,i._)("button",{class:(0,F.C_)(["btn btn-primary mt-3",[this.allInfoReady?"disabled":""]]),onClick:t[5]||(t[5]=(...e)=>o.transformFile&&o.transformFile(...e))},"TRANSFORM",2),(0,i._)("a",{class:(0,F.C_)(["btn mt-3",[""===this.download_workbook?"disabled btn-secondary":"btn-success"]]),onClick:t[6]||(t[6]=(...e)=>o.downloadFile&&o.downloadFile(...e))},"DOWNLOAD",2)])}function ke(e){const t=e["TASK REFERENCE"];return void 0===t?"":t.replaceAll(/\r|\n/g,"").trim()}function _e(e){return"MC"}function Ye(e){return e["SKILL"].replaceAll(/\r|\n/g,"")}function ye(e){return e["SOURCES"].toLowerCase().includes("cmr")||e["SOURCES"].toLowerCase().includes("awl")?"I":"N"}function Be(e){return e["SOURCES"].toLowerCase().includes("cmr")||e["SOURCES"].toLowerCase().includes("awl")?"N":"Y"}function xe(e){return"to be filled"===e?e:0===e.trim().length?"Y":"N"}function je(e){const t=e["SOURCES"];return t?t.includes("CMR")?"CMR":t.includes("AWL")?"AWL":t.includes("AD")?"AD":t.includes("MRBR")?"MRBR":t.includes("LUR")?"LUR":t.includes("CPCP")?"CPCP":0===t.trim().length?"":t.split(":")[0].replaceAll(/[\(\)]/g,"").trim():""}function Qe(e){return"to be filled"}function Ke(e){const t={code:"",value:""},n=e["THRESHOLD/INTERVAL/SAMPLE"].replaceAll(/\r/g,"");if(n&&(n.includes("T:")||n.includes("T :"))){const e=n.split("\n"),l=e.filter((e=>(e.includes("T:")||e.includes("T :"))&&e.includes("FH")))[0];l&&l.trim().length>0&&(t.code="FH",t.value=l.split(":")[1].trim().split(" ")[0].trim())}return t}function $e(e){const t={code:"",value:""},n=e["THRESHOLD/INTERVAL/SAMPLE"].replaceAll(/\r/g,"");if(n&&(n.includes("T:")||n.includes("T :"))){const e=n.split("\n"),l=e.filter((e=>(e.includes("T:")||e.includes("T :"))&&(e.includes("FC")||e.includes("LD"))))[0];l&&l.trim().length>0&&(t.code="FC",t.value=l.split(":")[1].trim().split(" ")[0].trim())}return t}function Ze(e){const t=["YE","MO","DY"],n={code:"",value:""},l=e["THRESHOLD/INTERVAL/SAMPLE"].replaceAll(/\r/g,"");if(l&&(l.includes("T:")||l.includes("T :"))){const e=l.split("\n"),i=e.filter((e=>(e.includes("T:")||e.includes("T :"))&&t.map((t=>e.includes(t))).filter((e=>1==e)).length>0))[0];i&&i.trim().length>0&&(n.code=i.split(":")[1].trim().split(" ")[1].trim(),n.value=i.split(":")[1].trim().split(" ")[0].trim())}return n}function Xe(e){const t=8e3,n=750;let l="";const i=e["THRESHOLD/INTERVAL/SAMPLE"].replaceAll(/\r/g,"");if(i&&(i.includes("I:")||i.includes("I :"))){const e=i.split("\n"),E=e.filter((e=>(e.includes("I:")||e.includes("I :"))&&e.includes("FH")))[0];E&&E.trim().length>0&&(l=E.split(":")[1].trim().split(" ")[0].trim());const r=e.filter((e=>(e.includes("I:")||e.includes("I :"))&&e.includes(" C")))[0];if(r&&r.trim().length>0){const e=r.split("I: ").filter((e=>e.length>0))[0].split(" ").filter((e=>e.length>0))[0];"C"==e?l=1*t:isNaN(Number(e))||(l=Number(e)*t)}const o=e.filter((e=>(e.includes("I:")||e.includes("I :"))&&e.includes(" A")))[0];if(o&&o.trim().length>0){const e=o.split("I: ").filter((e=>e.length>0))[0].split(" ").filter((e=>e.length>0))[0];"A"==e?l=1*n:isNaN(Number(e))||(l=Number(e)*n)}}return String(l)}function Ge(e){let t="";const n=e["THRESHOLD/INTERVAL/SAMPLE"].replaceAll(/\r/g,"");if(n&&(n.includes("I:")||n.includes("I :"))){const e=n.split("\n"),l=e.filter((e=>(e.includes("I:")||e.includes("I :"))&&(e.includes("FC")||e.includes("LD"))))[0];l&&l.trim().length>0&&(t=l.split(":")[1].trim().split(" ")[0].trim())}return t}function ze(e){const t=["YE","MO","DY"],n={code:"",value:""},l=e["THRESHOLD/INTERVAL/SAMPLE"].replaceAll(/\r/g,"");if(l&&(l.includes("I:")||l.includes("I :"))){const e=l.split("\n"),i=e.filter((e=>(e.includes("I:")||e.includes("I :"))&&t.map((t=>e.includes(t))).filter((e=>1==e)).length>0))[0];i&&i.trim().length>0&&(1==i.split(":")[1].trim().split(" ").length?(n.code=i.split(":")[1].trim().split(" ")[0].trim(),n.value="1"):(n.code=i.split(":")[1].trim().split(" ")[1].trim(),n.value=i.split(":")[1].trim().split(" ")[0].trim()))}const i=e["SOURCES"].replaceAll(/\r/g,"");if(i&&i.includes("LUR")){const e=i.trim().split("\n").filter((e=>e.includes("LUR")));let t;e.length>0&&(t=e[0].replaceAll(/\(|\)/g,"").split(":")[1].split("=")[1].split(" ")[0].trim()),["YE","MO","DY"].forEach((e=>{t.includes(e)&&(n.code=e,n.value=t.replace(e,""))}))}return n}function We(e){const t=!!(e["EQUIPMENT"]&&e["EQUIPMENT"].replaceAll(/\r|\n/g,"").trim().length>0);if(t)return"TCC";let n="";const l=e["THRESHOLD/INTERVAL/SAMPLE"].replaceAll(/\r/g,""),i=e["SOURCES"].replaceAll(/\r/g,""),E=[" A"," C"," WY"];if(i&&i.includes("LUR")){const e=i.trim().split("\n").filter((e=>e.includes("LUR")));if(e.length>0&&e[0].includes("or NR"))return"to be filled"}if(l&&(l.includes("I:")||l.includes("I :"))){const e=l.split("\n");let t=e.filter((e=>(e.includes("I:")||e.includes("I :"))&&e.includes("NR")))[0];if(t&&t.trim().length>0)return"to be filled";t=e.filter((e=>(e.includes("I:")||e.includes("I :"))&&E.map((t=>e.includes(t))).filter((e=>1==e)).length>0)),1==t.length?n=t[0].split(":")[1].replaceAll(/\s/g,"").trim():t.length>1&&(n="to be filled")}return n}function qe(e){const t=e["ZONE"];if(void 0===t)return"";const n=t.replaceAll(/\r/g,"").split("\n").filter((e=>0!==e.trim().length));while(n.length<22)n.push("");return n}function Je(e){const t=e["ACCESS"];if(void 0===t)return"";const n=t.replaceAll(/\r/g,"").split("\n").filter((e=>0!==e.trim().length));while(n.length<50)n.push("");return n}function et(e){const t=e["SKILL"];return void 0===t?"":t.replaceAll(/\r|\n/g,"").trim()}function tt(e){const t=e["MH/ZONE"];return void 0===t?"":t.replaceAll(/\r/g,"").split("\n")[0].trim()}function nt(e){const t=e["MAN"];return void 0===t?"":t.replaceAll(/\r/g,"").split("\n")[0].trim()}function lt(e){let t=e["TITLE"],n=!1;if(void 0===t)return["",n];t=t.replaceAll(/\r/g,"").replaceAll(/\n/g," ").trim();while(t.length>40){n=!0;const e=t.split(" ");t=e.slice(0,e.length-1).join(" ")}return[t,n]}function it(e){const t=e.split(" ").reduce(((e,t)=>(e[e.length-1]+" "+t).trim().length<76?[...e.slice(0,e.length-1),(e[e.length-1]+" "+t).trim()]:[...e,t]),[""]);return t}function Et(e){let t=e["DESCRIPTION"],n=e["PREPARATION DESCRIPTION"],l=e["EFFECTIVITY"];if(void 0===t){const e=[];while(e.length<16)e.push("");return e}t=t.replaceAll(/\r/g,"").trim(),n=n.replaceAll(/\r/g,"").trim(),l=l.replaceAll(/\r/g,"").trim();let i=t.split("\n").filter((e=>0!=e.length)),E=n.split("\n").filter((e=>0!=e.length)),r=l.split("\n").filter((e=>0!=e.length));if(i.length+E.length+r.length<=14){let e=[...i,E!=[""]&&0!==E.length?"PREPARATION:":"",...E,r!=[""]&&0!==r.length?"EFFECTIVITY:":"",...r].filter((e=>0!==e.length));while(e.length<16)e.push("");return e}if(t=t.replaceAll(/\r/g,"").replaceAll(/\n/g," ").trim(),n=n.replaceAll(/\r/g,"").replaceAll(/\n/g," ").trim(),l=l.replaceAll(/\r/g,"").replaceAll(/\n/g," ").trim(),i=it(t),E=it(n),r=it(l),i.length+E.length+r.length<=14){let e=[...i,E!=[""]?"PREPARATION:":"",...E,r!=[""]?"EFFECTIVITY:":"",...r].filter((e=>0!==e.length));while(e.length<16)e.push("");return e}if(E=it("PREPARATION: "+n),r=it("EFFECTIVITY: "+l),i.length+E.length+r.length<=16){let e=[...i,...E,...r];while(e.length<16)e.push("");return e}const o=t+" PREPARATION: "+n+" EFFECTIVITY: "+l,a=it(o);if(16===a.length)return a;while(a.length<16)a.push("");return a}function rt(e){const t=e["TASK REFERENCE"];return void 0===t?"":t.replaceAll(/\r|\n/g,"").trim().slice(0,2)}function ot(e,t,n,l){e.forEach((e=>{e.includes(t)&&n.push({reference:["MP","ESP"].includes(t)?e.trim().split(t+":").filter((e=>0!=e.length))[0].trim():["MPD","CPCP"].includes(t)?"MPD"==t?l:"":e.replaceAll(/\(|\)/g,"").trim().split(t+" :").filter((e=>0!=e.length))[0].trim(),type:t})}))}function at(e){const t=e["JOB PROCEDURE"],n=e["SOURCES"];let l=e["TASK REFERENCE"];if(void 0===n)return[{reference:"",type:""},{reference:"",type:""},{reference:"",type:""},{reference:"",type:""},{reference:"",type:""}];l&&(l=l.replaceAll(/\r|\n|\s/g,""));const i=[],E=t.replaceAll(/\r/g,"").split("\n").filter((e=>0!==e.length)),r=n.replaceAll(/\r/g,"").split("\n").filter((e=>0!==e.length));["MP","ESP"].forEach((e=>{ot(E,e,i,l)})),["CMR","AWL","AD","MRBR","LUR","CPCP","CDCCL","MPD"].forEach((e=>{ot(r,e,i,l)})),E.forEach((e=>{const t=e.trim().split(":"),n=t[0].trim(),l=t[1].trim();["MP","ESP"].includes(n)||i.push({reference:l,type:n})}));while(i.length<5)i.push({reference:"",type:""});return i}function st(e){const t=e["REV CODE"];return void 0===t?"":t.replaceAll(/\r|\n/g,"")}function ct(e,t,n,l,i){let E="";return e.length>22&&(E+="(more than 22 zones)"),t.length>50&&(E+="(more than 50 acces)"),n[1]&&(E+="(title with more than 50 characters)"),l.length>16&&(E+="(more than 16 cells for text)"),i.length>5&&(E+="(more than 5 documents linked)"),E}function ut(e,t){const n=[];return e.forEach((e=>{const l=Ke(e),i=$e(e),E=Ze(e),r=ze(e),o=We(e),a=qe(e),s=Je(e),c=lt(e),u=Et(e),d=at(e),A={"RÃ©fÃ©rence de la Carte":ke(e),"Type de la Carte":_e(e),"SpÃ©cialitÃ©":Ye(e),"ContrÃ´le":ye(e),Report:Be(e),"Out of Phase":xe(o),Phase:"",Poste:"","CatÃ©gorie MRB":je(e),"Code Tache":Qe(e),Note:"","Texte de la Note 1":"","Texte de la Note 2":"","Texte de la Note 3":"","Code Seuil 1":l.code,"Seuil 1":l.value,"Code Seuil 2":i.code,"Seuil 2":i.value,"Code Seuil 3":E.code,"Seuil 3":E.value,Heures:Xe(e),Cycles:Ge(e),"Code Cal.":r.code,Calendaire:r.value,"Code Check":o,"Code Atypique 1":"","Intervalle Atypique 1":"","Code Atypique 2":"","Intervalle Atypique 2":"","Code Atypique 3":"","Intervalle Atypique 3":"","TolÃ©rance - TolÃ©rance":"","TolÃ©rance - Name":"","TolÃ©rance - Heures":"","TolÃ©rance - Cycles":"","TolÃ©rance - Calendaire":"","TolÃ©rance - Code Calendaire":"","TolÃ©rance - CPT1":"","TolÃ©rance - CPT2":"","TolÃ©rance - CPT3":"","MÃ©thode de Calcul calendaire":"","MÃ©thode de Calcul autres":"",...a.reduce(((e,t,n)=>(Object.keys(e).length<22&&(e[`A/C ZONE ${n+1}`]=t),e)),{}),...s.reduce(((e,t,n)=>(Object.keys(e).length<50&&(e[`ACCES ${n+1}`]=t),e)),{}),"Famille MSN 1":"","Famille MSN 2":"","Famille MSN 3":"","Famille MSN 4":"","Famille MSN 5":"","Ressource (Qualification) 1":et(e),"Charge H.h 1":tt(e),"Nombre 1":nt(e),"Ressource (Qualification) 2":"","Charge H.h 2":"","Nombre 2":"","Ressource (Qualification) 3":"","Charge H.h 3":"","Nombre 3":"","LibellÃ© de la Carte":c[0],...u.reduce(((e,t,n)=>(Object.keys(e).length<16&&(e[`Text Ligne ${n+1}`]=t),e)),{}),ATA:rt(e),"LibellÃ© de l'ATA (optionnel)":"","RÃ©fÃ©rence document liÃ© 1":d[0].reference,"Type de Document 1":d[0].type,"RÃ©fÃ©rence document liÃ© 2":d[1].reference,"Type de Document 2":d[1].type,"RÃ©fÃ©rence document liÃ© 3":d[2].reference,"Type de Document 3":d[2].type,"RÃ©fÃ©rence document liÃ© 4":d[3].reference,"Type de Document 4":d[3].type,"RÃ©fÃ©rence document liÃ© 5":d[4].reference,"Type de Document 5":d[4].type,"NumÃ©ro Amendement":t["mpEdition"],"Date Amendement":t["mpEditionDate"],"NumÃ©ro RÃ©vision":t["mpdRevisionValue"],"Date RÃ©vision":t["mpdRevisionDate"],"Type de modification":st(e),Comments:ct(a,s,c,u,d)};n.push(A)})),n}const dt=n(7092);var At={name:"MPDTransformationATR",data(){return{workbook:"",download_workbook:"",mpEdition:"",mpEditionDate:"",mpdRevisionValue:"",mpdRevisionDate:""}},computed:{allInfoReady(){return""===this.workbook||""===this.mpEdition||""===this.mpEditionDate||""===this.mpdRevisionValue||""===this.mpdRevisionDate},allVariablesAffectingDownload(){return[this.workbook,this.mpEdition,this.mpEditionDate,this.mpdRevisionValue,this.mpdRevisionDate]}},methods:{readFile(){const e=document.querySelector("#file-input");this.file=e.files[0];const t=new FileReader;return t.onload=e=>{const t=e.target.result,n=dt.read(t,{type:"binary"});this.workbook=n},t.readAsBinaryString(this.file)},transformFile(){this.transformFileNormal()},transformFileNormal(){const e=this.workbook.Sheets["MPDTasks"],t=dt.utils.sheet_to_json(e,{header:["REV CODE","TASK REFERENCE","TITLE","DESCRIPTION","SECTION","THRESHOLD/INTERVAL/SAMPLE","SOURCES","EFFECTIVITY","JOB PROCEDURE","ZONE","MH/ZONE","MAN","ACCESS","MH/ACCESS","PREPARATION DESCRIPTION","MH/PREPARATION","SKILL","EQUIPMENT"]});let n=t.slice(2);const l={mpEdition:this.mpEdition,mpEditionDate:this.mpEditionDate,mpdRevisionValue:this.mpdRevisionValue,mpdRevisionDate:this.mpdRevisionDate},i=ut(n,l),E=dt.utils.json_to_sheet(i);this.download_workbook=dt.utils.book_new(),this.download_workbook.SheetNames.push("MPD induction AMASIS"),this.download_workbook.Sheets["MPD induction AMASIS"]=E},downloadFile(){let e="file";dt.writeFile(this.download_workbook,`${e}.xlsx`)}},watch:{allVariablesAffectingDownload(){this.download_workbook=""}},mounted(){}};const Rt=(0,r.Z)(At,[["render",we],["__scopeId","data-v-68770c52"]]);var Tt=Rt,Ct={name:"MPDTransformationView",components:{MPDTransformation:pe,MPDTransformationATR:Tt}};const Lt=(0,r.Z)(Ct,[["render",v],["__scopeId","data-v-3cfa67d0"]]);var St=Lt;const ft=[{path:"/",name:"home",component:O},{path:"/MPD-transformation",name:"MPD-transformation",component:St}],pt=(0,c.p7)({history:(0,c.r5)(),routes:ft});var Ot=pt,ht=n(65),Nt=(0,ht.MT)({state:{},getters:{},mutations:{},actions:{},modules:{}});n(2166);(0,l.ri)(s).use(Nt).use(Ot).mount("#app")}},t={};function n(l){var i=t[l];if(void 0!==i)return i.exports;var E=t[l]={exports:{}};return e[l].call(E.exports,E,E.exports,n),E.exports}n.m=e,function(){var e=[];n.O=function(t,l,i,E){if(!l){var r=1/0;for(c=0;c<e.length;c++){l=e[c][0],i=e[c][1],E=e[c][2];for(var o=!0,a=0;a<l.length;a++)(!1&E||r>=E)&&Object.keys(n.O).every((function(e){return n.O[e](l[a])}))?l.splice(a--,1):(o=!1,E<r&&(r=E));if(o){e.splice(c--,1);var s=i();void 0!==s&&(t=s)}}return t}E=E||0;for(var c=e.length;c>0&&e[c-1][2]>E;c--)e[c]=e[c-1];e[c]=[l,i,E]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){n.d=function(e,t){for(var l in t)n.o(t,l)&&!n.o(e,l)&&Object.defineProperty(e,l,{enumerable:!0,get:t[l]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={143:0};n.O.j=function(t){return 0===e[t]};var t=function(t,l){var i,E,r=l[0],o=l[1],a=l[2],s=0;if(r.some((function(t){return 0!==e[t]}))){for(i in o)n.o(o,i)&&(n.m[i]=o[i]);if(a)var c=a(n)}for(t&&t(l);s<r.length;s++)E=r[s],n.o(e,E)&&e[E]&&e[E][0](),e[E]=0;return n.O(c)},l=self["webpackChunkproject"]=self["webpackChunkproject"]||[];l.forEach(t.bind(null,0)),l.push=t.bind(null,l.push.bind(l))}();var l=n.O(void 0,[998],(function(){return n(132)}));l=n.O(l)})();
//# sourceMappingURL=app.2d2bc4b7.js.map